"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};$(function(){var e="Házi feladat hozzáadása",t="object"!==("undefined"==typeof _dispDays?"undefined":_typeof(_dispDays))?"":_dispDays.slice(),a=!1,o=[],n=$("#lessonPicker"),i=$("#startDatePicker");"undefined"!=typeof $.fn.sceditor&&$(".BBCodeEditor").sceditor({plugins:"bbcode",toolbar:"bold,italic,underline|color,removeformat|cut,copy,paste|source",style:"/resources/addons/sceditor/jquery.sceditor.default.min.css",height:"170px",runWithoutWysiwygSupport:!0,locale:"hu",emoticonsEnabled:!1});var l=function(){var e=-1,t=$("tr");t.eq(1).children().each(function(t,a){var o=$(a);0==o.children().length&&(o.remove(),e=t)}),e!=-1&&(t.eq(0).children().eq(e).remove(),t.each(function(e,t){0==$(t).children().length&&$(t).remove()}))};n.on("click",".lesson",function(){$(".selectedLesson").removeClass("selectedLesson"),$(this).addClass("selectedLesson")}),$(".js_add_hw").click(function(){$(this).blur()});var s=function(e){e.preventDefault();var t=$(e.currentTarget),o=t.attr("href").substring(1),n="Házi feladat késznek jelölése";$.Dialog.wait(n),$.ajax({method:"POST",data:{id:o},url:"/homeworks/makeMarkedDone",success:function(i){return"object"!==("undefined"==typeof i?"undefined":_typeof(i))?(console.log(i),$(window).trigger("ajaxerror"),!1):void(i.status?(a?($(e.currentTarget).replaceWith("<a class='typcn typcn-times js_undoMarkedDone' title='Késznek jelölés visszavonása' href='#"+o+"'></a>"),$("[href=#"+o+"]").filter(".js_undoMarkedDone").on("click",r)):(t.parent().detach(),l(),0==$("tbody").children().length&&$(".notice").show()),$.Dialog.close()):$.Dialog.fail(n,i.message))}})};$(".js_makeMarkedDone").click(s);var r=function(e){e.preventDefault();var t=$(e.currentTarget),a=t.attr("href").substring(1),o="Házi feladat kész jelölésének eltávolítása";$.Dialog.wait(o),$.ajax({method:"POST",data:{id:a},url:"/homeworks/undoMarkedDone",success:function(t){return"object"!==("undefined"==typeof t?"undefined":_typeof(t))?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($(e.currentTarget).replaceWith("<a class='typcn typcn-tick js_makeMarkedDone' title='Késznek jelölés' href='#"+a+"'></a>"),$("[href=#"+a+"]").filter(".js_makeMarkedDone").on("click",s),$.Dialog.close()):$.Dialog.fail(o,t.message))}})};$(".js_undoMarkedDone").click(r);var c=function(e){e.preventDefault();var t=$(".hwContent"),o="Házi feladatok lekérése";$.Dialog.wait(o),$.ajax({method:"POST",url:"/homeworks/getDoneHomeworks",dataType:"html",success:function(e){t.empty().append(e),$(".js_hideMarkedDone").on("click",d),$.Dialog.close(),$(".js_undoMarkedDone").click(r),$(".js_makeMarkedDone").click(s),a=!0},error:function(){$.Dialog.fail(o,"A házi feladatok lekérése nem sikerült egy ismeretlen hiba miatt!")}})};$(".js_showMarkedDone").on("click",c);var d=function(e){e.preventDefault();var t=$(".hwContent"),o="Házi feladatok lekérése";$.Dialog.wait(o),$.ajax({method:"POST",url:"/homeworks/getNotDoneHomeworks",dataType:"html",success:function(e){t.empty().append(e),$(".js_showMarkedDone").on("click",c),$.Dialog.close(),$(".js_undoMarkedDone").click(r),$(".js_makeMarkedDone").click(s),a=!1},error:function(){$.Dialog.fail(o,"A házi feladatok lekérése nem sikerült egy ismeretlen hiba miatt!")}})};$(".uploadField").on("change",function(e){o=e.target.files;var t=$(".infoContainer");"undefined"!=typeof o[0]?(t.show(),$(document.body).animate({scrollTop:t.offset().top-10},500)):t.hide()}),$(".sendForm").on("click",function(t){t.preventDefault();var a=$(".selectedLesson"),n=$(".BBCodeEditor").data("sceditor").val();if(0==a.length)return $.Dialog.fail(e,"A házi feladat hozzáadása nem sikerült, mert nincs kiválasztott tantárgy!");if(n.length<=7)return $.Dialog.fail(e,"A házi feladat hozzáadása nem sikerült, mert a házi feladat szövege kisebb mint nyolc!");$.Dialog.wait(e);var i=new FormData;$.each(o,function(e,t){i.append(e,t)}),"undefined"!=typeof o[0]&&(i.append("fileTitle",$("[name=fileTitle]").val()),i.append("fileDesc",$("[name=fileDesc]").val())),$.each({lesson:a.find(".del").attr("data-ttid"),text:n,week:a.closest("td").attr("data-week")},function(e,t){i.append(e,t)}),$.ajax({method:"POST",cache:!1,dataType:"json",processData:!1,contentType:!1,data:i,success:function(t){return"object"!==("undefined"==typeof t?"undefined":_typeof(t))?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($.Dialog.success(e,t.message),setTimeout(function(){window.location.href="/homeworks"},2500)):$.Dialog.fail(e,t.message))}})});var f,u=$(".backWeek").on("click",function(){m("back")}),k=$(".nextWeek").on("click",function(){m("next")}),h="Órakiválasztó-felület frissítése",m=function(e){var a=$("#lessonPicker"),o=$(".backWeek");return"back"==e&&"disabled"==o.attr("disabled")?$.Dialog.fail(h,"A jelenlegi hétről nem tudsz visszalépni egy előző hétre!"):($.Dialog.wait(h),void $.ajax({method:"POST",url:"/homeworks/getTimetable/nextBack",data:{move:e,dispDays:t},success:function(e){t=e.dispDays,a.children().html(e.timetable),o.attr("disabled",e.lockBack).blur(),k.blur(),i.val(t[0]),$.Dialog.close()}}))};i.on("change",function(e){e.preventDefault();var a=$(this).val();return isNaN(Date.parse(a))?$.Dialog.fail("Léptetés","Érvénytelen dátum!"):("undefined"!=typeof f&&(f.abort(),f=void 0),$.Dialog.open&&"wait"===$.Dialog.open.type||$.Dialog.wait(h),void(f=$.ajax({method:"POST",url:"/homeworks/getTimetable/date",data:{date:a},success:function(e){t=e.dispDays,n.children().html(e.timetable),u.attr("disabled",e.lockBack).blur(),k.blur(),i.val(t[0]),$.Dialog.close(),f=void 0}})))}),$(".js_delete").click(function(e){e.preventDefault();var t=$(e.currentTarget),a=t.attr("href").substring(1),o="Házi feladat törlése";$.Dialog.confirm(o,"Arra készülsz, hogy törlöd a kiválasztott házi feladatot. Ez nem azt jelenti, hogy nem kell azt megcsinálnod, csupán azt, hogy azt a rendszer többé nem jelzi. Biztosan törlöd a bejegyzést a rendszerből?",["Bejegyzés törlése","Visszalépés"],function(e){e&&($.Dialog.wait(),$.ajax({method:"POST",url:"/homeworks/delete",data:{id:a},success:function(e){return"object"!==("undefined"==typeof e?"undefined":_typeof(e))?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?(t.parent().remove(),l(),0==$("tbody").children().length&&$(".notice").show(),$.Dialog.close()):$.Dialog.fail(o,e.message))}}))})});var g=function(e){e.preventDefault(),$.Dialog.fail("Funkció fejlesztés alatt","A kívánt funckió jelen pillanatban nem elérhető, mert az még fejlesztés alatt van! Próbálkozz később!")};$(".js_finished").click(g),$(".js_more_info").click(g)});
//# sourceMappingURL=homeworks.js.map
