"use strict";$(function(){$("#js_hideShowFilter").on("click",function(){var t=$(this),e=$("#filterFormContainer");t.toggleClass("typcn-arrow-up-thick typcn-arrow-down-thick hide show"),e[t.hasClass("hide")?"show":"hide"](),t.text(t.hasClass("hide")?"Szűrőpanel összecsukása":"Szűrőpanel kinyitása"),t.blur()}),$("#filterForm").on("submit",function(t){t.preventDefault(),$.Dialog.wait(),$.ajax({method:"POST",url:"/system.classes/filter",data:$("#filterForm").serializeForm(),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($("#resultContainer").empty().append(t.html),$.Dialog.close(),$(".js_filterClasses").blur()):$.Dialog.fail(title,t.message))}})});var t=$("<form id='js_form'>\t\t\t\t\t\t<p>Osztály iskolai azonosítója: <input type='text' name='classid' placeholder='10.X' required></p>\t\t\t\t\t\t<input type='hidden' name='id' value=''>\t\t\t\t\t</form>");$("#js_editBasicInfos").on("click",function(e){e.preventDefault();var a=$(e.currentTarget).attr("data-id"),s="Osztály alapadatainak szerkesztése";$.Dialog.wait(s,"Alapadatok lekérdezése"),$.ajax({method:"POST",url:"/system.classes/get/basicInfos",data:{id:a},success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){var i=t.clone();i.find("[name=classid]").attr("value",e.classid),i.find("[name=id]").attr("value",a),$.Dialog.request(s,i,"js_form","Mentés",function(){var t=$("#js_form");t.on("submit",function(e){e.preventDefault(),$.Dialog.wait(s),$.ajax({method:"POST",url:"/system.classes/editBasicInfos",data:t.serializeForm(),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($.Dialog.success(s,t.message),setTimeout(function(){window.location.reload()},1500)):$.Dialog.fail(s,t.message))}})})})}else $.Dialog.fail(s,e.message)}})}),$("#js_enterClass").on("click",function(t){t.preventDefault();var e=$(t.currentTarget).attr("data-id"),a="Belépés az osztályba mint adminisztrátor";$.Dialog.confirm(a,"Arra készül, hogy belép a kiválasztott osztályba, mint az osztály adminisztrátora! Folytatja a műveletet?",["Belépés az osztályba","Visszalépés"],function(t){t&&($.Dialog.wait(a),$.ajax({method:"POST",url:"/system.classes/enterClass",data:{classid:e},success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($.Dialog.success(a,t.message),setTimeout(function(){window.location.href="/"},1500)):$.Dialog.fail(a,t.message))}}))})});var e=$("<tr>\t\t\t\t\t\t<td class='check'><input type='checkbox' data-id=''></td>\t\t\t\t\t\t<td data-type='id'></td>\t\t\t\t\t\t<td data-type='name'></td>\t\t\t\t\t\t<td data-type='email'></td>\t\t\t\t\t\t<td data-type='role' class='check'>\t\t\t\t\t\t\t<select>\t\t\t\t\t\t\t\t<option value='visitor'>Ált. felhasználó</option>\t\t\t\t\t\t\t\t<option value='editor'>Szerkesztő</option>\t\t\t\t\t\t\t\t<option value='admin'>Csoport adminisztrátor</option>\t\t\t\t\t\t\t</select>\t\t\t\t\t\t</td>\t\t\t\t\t</tr>");$("#js_openUserSelector").on("click",function(t){t.preventDefault(),$(t.currentTarget).blur();var s=window.open("/system.popup","Felhasználók kiválasztása","height=720,width=800");window.response=function(t){s.close();for(var i=0;i<t.length;i++){var o=t[i];if(0==$("input[data-id="+o.id+"]").length){var n=e.clone();n.find(".check > input").attr("data-id",o.id).addClass("via-js"),n.find("[data-type=id]").text(o.id),n.find("[data-type=name]").text(o.name),n.find("[data-type=email]").text(o.email),$("tbody .new").before(n),$(".via-js").click(a)}}}});var a=function(t){$(t.currentTarget).parent().parent().remove()};$("#js_sendForm").on("click",function(t){t.preventDefault();var e="Taglista módosítása",a=[];$.Dialog.wait(e),$("input[type=checkbox]").each(function(t,e){var s=$(e),i=s.parent().parent();a.push({id:s.attr("data-id"),role:i.find('[data-type="role"]').children("select").val(),remove:s.prop("checked")?"1":"0",classid:$("input[name=classid]").val()})}),$.ajax({method:"POST",url:"/system.classes/manageMembers",data:{data:a},success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($.Dialog.success(e,t.message),setTimeout(function(){window.location.reload()},1500)):$.Dialog.fail(e,t.message))}})})});
//# sourceMappingURL=system.classes.js.map
