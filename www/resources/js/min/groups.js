"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};$(function(){var t=$("<form id='js_form'>\t\t\t\t\t\t\t<p>Kategória neve: <input type='text' name='name' placeholder='Kategória neve' required></p>\t\t\t\t\t  </form>"),e=$("<li>\t\t\t\t\t\t\t<div class='top'>\t\t\t\t\t\t\t\t<span class='rovid'></span>\t\t\t\t\t\t\t\t<span class='nev'></span>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class='bottom'>\t\t\t\t\t\t\t\t<a class='typcn typcn-pencil js_thm_edit' title='Módosítás'></a>\t\t\t\t\t\t\t\t<a class='typcn typcn-trash js_thm_del' title='Törlés'></a>\t\t\t\t\t\t\t</div>\t\t\t\t\t   </li>"),a=$("<div><h2 class='grouptitle'></h2>\t\t\t\t\t\t<ul class='groups colorli'>\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t<div class='top'>\t\t\t\t\t\t\t\t\t<span class='rovid'>Új csop.</span>\t\t\t\t\t\t\t\t\t<span class='nev newTile'>Új csoport hozzáadása</span>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class='bottom'>\t\t\t\t\t\t\t\t\t<a class='typcn typcn-plus' href='/groups/add/' title='Hozzáadás'></a>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</li>\t\t\t\t\t\t</ul></div>"),r=$("#groupContainer");$(".js_grp_del").on("click",function(t){t.preventDefault();var e="Csoport törlése";$.Dialog.confirm(e,"Biztosan törlöd a csoportot? Ha a csoportnak vannak tagjai, a rendszer automatikusan kilépteti őket.",["Csop. törlése","Visszalépés"],function(a){if(a){var r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/groups/delete",data:{id:r},success:function(t){t.status?($.Dialog.success(e,t.message),window.location.href="/groups"):$.Dialog.fail(e,t.message)}})}})});var o=function(e){e.preventDefault();var a="Csoportkategória szerkesztése",r=$(e.currentTarget).attr("href").substring(1);$.Dialog.wait(a,"Információk lekérése a szerverről"),$.ajax({method:"POST",url:"/groups/theme/get",data:{id:r},success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;var o=t.clone();o.find("[name=name]").attr("value",e.name),$.Dialog.request(a,o,"js_form","Mentés",function(t){t.on("submit",function(e){e.preventDefault();var o=t.serializeForm();o.id=r,$.Dialog.wait(a),$.post({method:"POST",url:"/groups/theme/edit",data:o,success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){var o=$(".grps"),i=o.children("[data-id="+r+"]"),s=t.children(),n=s.find("[name=name]").val();i.find(".rovid").text(n+" kat.");var l=$(".new").detach();o.sortChildren(".rovid",!1),o.append(l),$('h2[data-thm="'+r+'"]').text(n+" csoportok"),$('div[data-thm="'+r+'"]').find("ul").find(".nev:not(.newTile)").text(n),$.Dialog.close()}else $.Dialog.fail(a,e.message)}})})})}})};$(".js_thm_edit").on("click",o);var i=function(i){i.preventDefault();var n="Csoportkategória hozzáadása",l=t.clone();$.Dialog.request(n,l.prop("outerHTML"),"js_form","Mentés",function(t){t.on("submit",function(i){i.preventDefault();var l=t.serializeForm();$.Dialog.wait(n),$.ajax({method:"POST",url:"/groups/theme/add",data:l,success:function(i){if("string"==typeof i)return console.log(i),$(window).trigger("ajaxerror"),!1;if(i.status){var l=e.clone(),d=t.children(),c=d.find("[name=name]").val();l.find(".rovid").text(c+" kat."),l.find(".js_thm_edit").attr("href","#"+i.id),l.find(".js_thm_del").attr("href","#"+i.id),l.attr("data-id",i.id);var u=$(".grps");u.append(l);var p=$(".new").detach();u.sortChildren(".rovid",!1),u.append(p),l.find(".js_thm_edit").on("click",o),l.find(".js_thm_del").on("click",s),$(".notice").hide();var f=a.clone();f.find(".grouptitle").text(c+" csoportok").attr("data-thm",i.id),f.find(".bottom").children().eq(0).attr("href","/groups/add/"+i.id),f.filter("div").attr("data-thm",i.id),r.append(f),$.Dialog.close()}else $.Dialog.fail(n,i.message)}})})})};$(".js_thm_add").on("click",i);var s=function(t){t.preventDefault();var e="Csoportkategória törlése";$.Dialog.confirm(e,"Biztosan törölni szeretnéd a csoportkategóriát? A kategóriában lévő összes csoport is törlődik. A művelet nem visszavonható!",["Kat. törlése","Visszalépés"],function(a){if(a){$.Dialog.wait();var r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/groups/theme/delete",data:{id:r},success:function(a){a.status?($(t.currentTarget).parent().parent().remove(),$("div[data-thm="+r+"]").remove(),0==$("#groupContainer").children().length&&$(".missingThemes").show(),$.Dialog.close()):$.Dialog.fail(e,a.message)}})}})};$(".js_thm_del").on("click",s);var n=function(t){t.preventDefault();var e=$(t.currentTarget).attr("href").substring(1),a="Csoport tagjainak lekérése";$.Dialog.wait(a),$.ajax({method:"POST",url:"/groups/members",data:{id:e},success:function(t){return"object"!==("undefined"==typeof t?"undefined":_typeof(t))?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?$.Dialog.info(a,t.html):$.Dialog.fail(a,t.message))}})};$(".js_grp_members").on("click",n)});
//# sourceMappingURL=groups.js.map
