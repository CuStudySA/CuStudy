"use strict";$(function(){var e,t=!1,a="<button class='typcn typcn-zoom btn js_switchToViewMode'>Visszatérés nézegető módba</button>",n=$(".js_switchToSelectionMode").clone(),i=!0,s=$("<form id='js_form'>\t\t\t\t\t\t\t<label><span>Esemény címe</span><input type='text' name='title' required></label>\t\t\t\t\t\t\t<label><span>Időtartam</span><input type='text' name='interval' id='dateRangePicker' required></label>\t                        <label><input type='checkbox' name='isFullDay' value='1' autocomplete='off'> Egész napos esemény</label>\t\t\t\t\t\t\t<label><span>Esemény rövid leírása</span><textarea name='description' required></textarea></label>\t\t\t\t\t\t</form>"),o=function(e){$.Dialog.wait("Esemény részletei","Esemény részleteinek lekérése"),$.ajax({method:"POST",url:"/events/getEventInfos",data:pushToken({id:e.id}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?$.Dialog.info(!1,e.html):$.Dialog.fail(!1,e.message))}})},l={events:"/events/getEvents",header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},eventLimit:!0,height:530,nextDayThreshold:"00:00:00",timezone:"local",eventClick:function(a){t?($(".selectedEvent").removeClass("selectedEvent"),$(this).addClass("selectedEvent"),e=a,$(".js_edit").attr("disabled",!1),$(".js_delete").attr("disabled",!1)):o(a)}},r=$("#calendar");r.fullCalendar(l),r.fullCalendar("addEventSource",{url:"/events/getGlobalEvents",className:"global-event"});var d=function(){$(this).blur(),t=!0,$(".js_switchToSelectionMode").replaceWith(a),$(".js_switchToViewMode").on("click",c)};$(".js_switchToSelectionMode").on("click",d);var c=function(){$(this).blur(),t=!1,$(".js_edit").attr("disabled",!0),$(".js_delete").attr("disabled",!0),e=void 0,$(".selectedEvent").removeClass("selectedEvent"),$(".js_switchToViewMode").replaceWith(n),$(".js_switchToSelectionMode").on("click",d)},u={startOfWeek:"monday",separator:" ~ ",autoClose:!1,language:"hu"};$.fn.drpConfigure=function(){var e=this,t=$("#dateRangePicker"),a=e.find("input[name=isFullDay]");return a.on("change",function(){i=!this.checked,"undefined"!=typeof t.data("dateRangePicker")&&t.data("dateRangePicker").destroy(),t.dateRangePicker($.extend({format:"YYYY.MM.DD."+(i?" HH:mm":""),time:{enabled:i}},u)),t.triggerHandler("change")}).triggerHandler("change"),this},$(".js_add").on("click",function(e){e.preventDefault();var t="Esemény hozzáadása";$.Dialog.request(t,s.clone(),"js_form","Mentés",function(e){e.drpConfigure().on("submit",function(a){a.preventDefault();var n=e.serializeForm();$.Dialog.wait(t),$.post("/events/add",n,function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):e.status?($("#calendar").fullCalendar("refetchEvents"),void $.Dialog.close()):$.Dialog.fail(t,e.message)})})})}),$(".js_edit").on("click",function(a){a.preventDefault();var o=s.clone();"undefined"!=typeof e&&($.Dialog.wait("Esemény szerkesztése","Esemény adatainak lekérése"),$.ajax({method:"POST",url:"/events/getEventInfos/all",data:pushToken({id:e.id}),success:function(a){return"string"==typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):a.status?(i=1!=a.isFullDay,o.find("input[name=isFullDay]").attr("checked",!i),o.find("input[name=interval]").attr("value",a.start+" ~ "+a.end),o.find("input[name=title]").attr("value",a.title),o.find("textarea[name=description]").text(a.description),$.Dialog.request(!1,o,"js_form","Mentés",function(a){a.drpConfigure().on("submit",function(i){i.preventDefault();var s=a.serializeForm();s.id=e.id,$.Dialog.wait(!1),$.post("/events/edit",s,function(a){return"string"==typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):a.status?($("#calendar").fullCalendar("refetchEvents"),e=void 0,$(".js_edit").attr("disabled",!0),$(".js_delete").attr("disabled",!0),$(".js_switchToViewMode").replaceWith(n),$(".js_switchToSelectionMode").on("click",d),t=!1,void $.Dialog.close()):$.Dialog.fail(!1,a.message)})})}),void 0):$.Dialog.fail(!1,a.message)}}))}),$(".js_delete").on("click",function(a){a.preventDefault();var i="Esemény törlése";"undefined"!=typeof e&&$.Dialog.confirm(i,"Arra készülsz, hogy törlöd a kiválasztott eseményt! Folytatod?",["Esemény törlése","Visszalépés"],function(a){a&&($.Dialog.wait(),$.ajax({method:"POST",url:"/events/delete",data:pushToken({id:e.id}),success:function(a){return"string"==typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?(r.fullCalendar("refetchEvents"),e=void 0,$(".js_edit").attr("disabled",!0),$(".js_delete").attr("disabled",!0),$(".js_switchToViewMode").replaceWith(n),$(".js_switchToSelectionMode").on("click",d),t=!1,$.Dialog.close()):$.Dialog.fail(i,a.message))}}))})})});
//# sourceMappingURL=events.min.js.map
