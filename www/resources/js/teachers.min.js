$(function(){var e=$("<form id='js_form'>							<p>Tanár neve: <input type='text' name='name' autocomplete='off' required></p>							<p>Tanár rövid neve: <input type='text' name='short' autocomplete='off' required></p>							<input type='hidden' name='id'>						</form>"),a=$("			<li>				<div class='top'>					<span class='rovid'></span>					<span class='nev'></span>				</div>				<div class='bottom'>					<a class='typcn typcn-pencil js_teacher_edit' title='Módosítás'></a>					<a class='typcn typcn-minus js_teacher_del' title='Törlés'></a>				</div>			</li>");"undefined"!=typeof Patterns&&$.each(Patterns,function(a,t){var n=e.find("[name="+a+"]");1==n.length&&n.attr("pattern",t)});var t,n=$(".add_teacher_form").detach().css("display","block"),r=function(e){e.preventDefault(),t instanceof jQuery&&t.remove(),t=n.clone(),$("main").append(t),$("#colorpicker").spectrum({showInput:!0,showInitial:!0,preferredFormat:"hex",change:function(e){$("#colorpicker").attr("value",e.toHexString())}}),$(document.body).animate({scrollTop:t.offset().top-10},500),$(".addlesson").click(function(e){e.preventDefault();var a=$(".a_l_name"),t=a.val(),n=$("#colorpicker").val(),r=new RegExp("^[A-Za-zöüóőúéáűÖÜÓŐÚÉÁŰ.() ]{4,15}$"),i=$(".l_l_utag"),o=!1,s="Óra hozzáadása";return r.test(t)?($.each(i.children(),function(e,a){var n=$(a).attr("data-name");return n==t?($.Dialog.fail(s,"Már létezik ilyen nevű tantárgy, válassz másik nevet!"),!(o=!0)):void 0}),void(o||(i.append('<li data-color="'+n+'" data-name="'+t+'"><span style="color: '+n+'" class="l_l_litag">'+t+'</span><span class="typcn typcn-times l_l_deleteopt"></span></li>'),$(".l_l_empty").remove(),a.val(""),$(".l_l_deleteopt").on("click",function(){var e=$(this).parent(),a=$(".l_l_utag");e.remove(),0==a.children().size()&&a.append('<li class="l_l_empty">(nincs)</li>')})))):void $.Dialog.fail(s,"A tantárgy formátuma nem megfelelő! A tantárgy csak a magyar ABC kis-, és nagybetűit tartalmazhatja!")});var s=[],l=!1;$(".a_t_f_sendButton").click(function(e){if(e.preventDefault(),l!==!0){l=!0;var n=$(".l_l_utag"),c=$(".teacher_info").find("input"),d="Tanár hozzáadása";$.each(n.children(),function(e,a){if(!$(a).hasClass("l_l_empty")){var t=$(a).attr("data-name"),n=$(a).attr("data-color");s.push({name:t,color:n})}});var f={lessons:s};c.filter('[name="name"], [name="short"]').each(function(e,a){var t=$(a),n=t.attr("name");f[n]=t.val()}),$.Dialog.wait(d),$.ajax({method:"POST",url:"/teachers/add",data:pushToken(f),success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){var n=a.clone();n.find(".rovid").text(f["short"]),n.find(".nev").text(f.name),n.find(".js_teacher_edit").attr("href","#"+e.id),n.find(".js_teacher_del").attr("href","#"+e.id),n.attr("data-id",e.id);var s=$(".teachers"),l=$(".new").detach();$(".js_teacher_add").on("click",r),n.find(".js_teacher_edit").on("click",i),n.find(".js_teacher_del").on("click",o),s.append(n),s.sortChildren(".rovid",!1),s.append(l),t.remove(),t=void 0,$.Dialog.close()}else $.Dialog.fail(d,e.message)},complete:function(){l=!1}})}})},i=function(a){a.preventDefault();var t="Tanár szerkesztése",n=$(a.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/teachers/get",data:pushToken({id:n}),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(1==a.status){var r=e.clone();r.find("[name=name]").attr("value",a.name),r.find("[name=short]").attr("value",a["short"]),r.find("[name=id]").attr("value",n),$.Dialog.request(t,r.prop("outerHTML"),"js_form","Mentés",function(e){e.on("submit",function(a){a.preventDefault();var r=e.serializeForm();$.Dialog.wait(t),$.ajax({method:"POST",url:"/teachers/edit",data:r,success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(a.status){var r=$(".teachers"),i=r.find("[data-id="+n+"]");i.find(".rovid").text(e.find("[name=short]").val()),i.find(".nev").text(e.find("[name=name]").val());var o=$(".new").detach();r.sortChildren(".rovid",!1),r.append(o),$.Dialog.close()}else $.Dialog.fail(t,a.message)}})})})}}})},o=function(e){e.preventDefault();var a=$(e.currentTarget).attr("href").substring(1),t="Tanár törlése";$.Dialog.confirm(t,"A kiválasztott tanár törlésére készülsz. Ez a művelet érintheti a tantárgyakat, és az egyéb tartalmakat is. Biztosan törlöd a tanárt a rendszerből?",["Tanár törlése","Visszalépés"],function(e){e&&($.Dialog.wait(t),$.ajax({method:"POST",url:"/teachers/delete",data:pushToken({id:a}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?($(document).find("[data-id="+a+"]").remove(),$.Dialog.close()):$.Dialog.fail(t,e.message))}}))})};$(".js_teacher_add").on("click",r),$(".js_teacher_edit").on("click",i),$(".js_teacher_del").on("click",o)});
//# sourceMappingURL=teachers.min.js.map
