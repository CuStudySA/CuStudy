"use strict";$(function(){var t=$("<form id='js_form'>\t\t\t\t\t\t\t<p>Tanár neve: <input type='text' name='name' autocomplete='off' required></p>\t\t\t\t\t\t\t<p>Tanár rövid neve: <input type='text' name='short' autocomplete='off' required></p>\t\t\t\t\t\t\t<input type='hidden' name='id'>\t\t\t\t\t\t</form>"),e=$("\t\t\t<li>\t\t\t\t<div class='top'>\t\t\t\t\t<span class='rovid'></span>\t\t\t\t\t<span class='nev'></span>\t\t\t\t</div>\t\t\t\t<div class='bottom'>\t\t\t\t\t<a class='typcn typcn-pencil js_teacher_edit' title='Módosítás'></a>\t\t\t\t\t<a class='typcn typcn-minus js_teacher_del' title='Törlés'></a>\t\t\t\t</div>\t\t\t</li>");"undefined"!=typeof Patterns&&$.each(Patterns,function(e,a){var n=t.find("[name="+e+"]");1==n.length&&n.attr("pattern",a)});var a,n=$(".add_teacher_form").detach().css("display","block"),r=function s(t){t.preventDefault(),a instanceof jQuery&&a.remove(),a=n.clone(),$("main").append(a),$("#colorpicker").spectrum({showInput:!0,showInitial:!0,preferredFormat:"hex",change:function(t){$("#colorpicker").attr("value",t.toHexString())}}),$(document.body).animate({scrollTop:a.offset().top-10},500),$(".addlesson").click(function(t){t.preventDefault();var e=$(".a_l_name"),a=e.val(),n=$("#colorpicker").val(),r=new RegExp("^[A-Za-zöüóőúéáűÖÜÓŐÚÉÁŰ.() ]{4,15}$"),i=$(".l_l_utag"),o=!1,s="Óra hozzáadása";return r.test(a)?($.each(i.children(),function(t,e){var n=$(e).attr("data-name");if(n==a)return $.Dialog.fail(s,"Már létezik ilyen nevű tantárgy, válassz másik nevet!"),!(o=!0)}),void(o||(i.append('<li data-color="'+n+'" data-name="'+a+'"><span style="color: '+n+'" class="l_l_litag">'+a+'</span><span class="typcn typcn-times l_l_deleteopt"></span></li>'),$(".l_l_empty").remove(),e.val(""),$(".l_l_deleteopt").on("click",function(){var t=$(this).parent(),e=$(".l_l_utag");t.remove(),0==e.children().size()&&e.append('<li class="l_l_empty">(nincs)</li>')})))):void $.Dialog.fail(s,"A tantárgy formátuma nem megfelelő! A tantárgy csak a magyar ABC kis-, és nagybetűit tartalmazhatja!")});var r=[],l=!1;$(".a_t_f_sendButton").click(function(t){if(t.preventDefault(),l!==!0){l=!0;var n=$(".l_l_utag"),c=$(".teacher_info").find("input"),d="Tanár hozzáadása";$.each(n.children(),function(t,e){if(!$(e).hasClass("l_l_empty")){var a=$(e).attr("data-name"),n=$(e).attr("data-color");r.push({name:a,color:n})}});var f={lessons:r};c.filter('[name="name"], [name="short"]').each(function(t,e){var a=$(e),n=a.attr("name");f[n]=a.val()}),$.Dialog.wait(d),$.ajax({method:"POST",url:"/teachers/add",data:pushToken(f),success:function(t){if("string"==typeof t)return console.log(t),$(window).trigger("ajaxerror"),!1;if(t.status){var n=e.clone();n.find(".rovid").text(f["short"]),n.find(".nev").text(f.name),n.find(".js_teacher_edit").attr("href","#"+t.id),n.find(".js_teacher_del").attr("href","#"+t.id),n.attr("data-id",t.id);var r=$(".teachers"),l=$(".new").detach();$(".js_teacher_add").on("click",s),n.find(".js_teacher_edit").on("click",i),n.find(".js_teacher_del").on("click",o),r.append(n),r.sortChildren(".rovid",!1),r.append(l),a.remove(),a=void 0,$.Dialog.close()}else $.Dialog.fail(d,t.message)},complete:function(){l=!1}})}})},i=function(e){e.preventDefault();var a="Tanár szerkesztése",n=$(e.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/teachers/get",data:pushToken({id:n}),success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(1==e.status){var r=t.clone();r.find("[name=name]").attr("value",e.name),r.find("[name=short]").attr("value",e["short"]),r.find("[name=id]").attr("value",n),$.Dialog.request(a,r.prop("outerHTML"),"js_form","Mentés",function(t){t.on("submit",function(e){e.preventDefault();var r=t.serializeForm();$.Dialog.wait(a),$.ajax({method:"POST",url:"/teachers/edit",data:r,success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){var r=$(".teachers"),i=r.find("[data-id="+n+"]");i.find(".rovid").text(t.find("[name=short]").val()),i.find(".nev").text(t.find("[name=name]").val());var o=$(".new").detach();r.sortChildren(".rovid",!1),r.append(o),$.Dialog.close()}else $.Dialog.fail(a,e.message)}})})})}}})},o=function(t){t.preventDefault();var e=$(t.currentTarget).attr("href").substring(1),a="Tanár törlése";$.Dialog.confirm(a,"A kiválasztott tanár törlésére készülsz. Ez a művelet érintheti a tantárgyakat, és az egyéb tartalmakat is. Biztosan törlöd a tanárt a rendszerből?",["Tanár törlése","Visszalépés"],function(t){t&&($.Dialog.wait(a),$.ajax({method:"POST",url:"/teachers/delete",data:pushToken({id:e}),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($(document).find("[data-id="+e+"]").remove(),$.Dialog.close()):$.Dialog.fail(a,t.message))}}))})};$(".js_teacher_add").on("click",r),$(".js_teacher_edit").on("click",i),$(".js_teacher_del").on("click",o)});
//# sourceMappingURL=teachers.min.js.map
