$(function(){var t=$("<form id='js_form'>							<p>Kategória neve: <input type='text' name='name' placeholder='Kategória neve' required></p>					  </form>"),e=$("<li>							<div class='top'>								<span class='rovid'></span>								<span class='nev'></span>							</div>							<div class='bottom'>								<a class='typcn typcn-pencil js_thm_edit' title='Módosítás'></a>								<a class='typcn typcn-trash js_thm_del' title='Törlés'></a>							</div>					   </li>"),a=$("<div><h2 class='grouptitle'></h2>						<ul class='groups colorli'>							<li>								<div class='top'>									<span class='rovid'>Új csop.</span>									<span class='nev newTile'>Új csoport hozzáadása</span>								</div>								<div class='bottom'>									<a class='typcn typcn-plus' href='/groups/add/' title='Hozzáadás'></a>								</div>							</li>						</ul></div>"),r=$("#groupContainer");$(".js_grp_del").on("click",function(t){t.preventDefault();var e="Csoport törlése";$.Dialog.confirm(e,"Biztosan törlöd a csoportot? Ha a csoportnak vannak tagjai, a rendszer automatikusan kilépteti őket.",["Csop. törlése","Visszalépés"],function(a){if(a){var r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/groups/delete",data:pushToken({id:r}),success:function(t){t.status?($.Dialog.success(e,t.message),window.location.href="/groups"):$.Dialog.fail(e,t.message)}})}})});var s=function(e){e.preventDefault();var a="Csoportkategória szerkesztése",r=$(e.currentTarget).attr("href").substring(1);$.Dialog.wait(a,"Információk lekérése a szerverről..."),$.ajax({method:"POST",url:"/groups/theme/get",data:pushToken({id:r}),success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;var s=t.clone();s.find("[name=name]").attr("value",e.name),$.Dialog.request(a,s,"js_form","Mentés",function(t){t.on("submit",function(e){e.preventDefault();var s=t.serializeForm();s.id=r,$.Dialog.wait(a),$.post({method:"POST",url:"/groups/theme/edit",data:s,success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){var s=$(".grps"),i=s.children("[data-id="+r+"]"),o=t.children(),n=o.find("[name=name]").val();i.find(".rovid").text(n+" kat.");var l=$(".new").detach();s.sortChildren(".rovid",!1),s.append(l),$('h2[data-thm="'+r+'"]').text(n+" csoportok"),$('div[data-thm="'+r+'"]').find("ul").find(".nev:not(.newTile)").text(n),$.Dialog.close()}else $.Dialog.fail(a,e.message)}})})})}})};$(".js_thm_edit").on("click",s);var i=function(i){i.preventDefault();var n="Csoportkategória hozzáadása",l=t.clone();$.Dialog.request(n,l.prop("outerHTML"),"js_form","Mentés",function(t){t.on("submit",function(i){i.preventDefault();var l=t.serializeForm();$.Dialog.wait(n),$.ajax({method:"POST",url:"/groups/theme/add",data:l,success:function(i){if("string"==typeof i)return console.log(i),$(window).trigger("ajaxerror"),!1;if(i.status){var l=e.clone(),d=t.children(),c=d.find("[name=name]").val();l.find(".rovid").text(c+" kat."),l.find(".js_thm_edit").attr("href","#"+i.id),l.find(".js_thm_del").attr("href","#"+i.id),l.attr("data-id",i.id);var u=$(".grps");u.append(l);var p=$(".new").detach();u.sortChildren(".rovid",!1),u.append(p),l.find(".js_thm_edit").on("click",s),l.find(".js_thm_del").on("click",o),$(".missingThemes").hide();var g=a.clone();g.find(".grouptitle").text(c+" csoportok").attr("data-thm",i.id),g.find(".bottom").children().eq(0).attr("href","/groups/add/"+i.id),g.filter("div").attr("data-thm",i.id),r.append(g),$.Dialog.close()}else $.Dialog.fail(n,i.message)}})})})};$(".js_thm_add").on("click",i);var o=function(t){t.preventDefault();var e="Csoportkategória törlése";$.Dialog.confirm(e,"Biztosan törölni szeretnéd a csoportkategóriát? A kategóriában lévő összes csoport is törlődik. A művelet nem visszavonható!",["Kat. törlése","Visszalépés"],function(a){if(a){$.Dialog.wait();var r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/groups/theme/delete",data:pushToken({id:r}),success:function(a){a.status?($(t.currentTarget).parent().parent().remove(),$("div[data-thm="+r+"]").remove(),0==$("#groupContainer").children().length&&$(".missingThemes").show(),$.Dialog.close()):$.Dialog.fail(e,a.message)}})}})};$(".js_thm_del").on("click",o);var n=function(t){t.preventDefault();var e=$(t.currentTarget).attr("href").substring(1),a="Csoport tagjainak lekérése";$.Dialog.wait(a),$.ajax({method:"POST",url:"/groups/members",data:pushToken({id:e}),success:function(t){return"object"!=typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?$.Dialog.info(a,t.html):$.Dialog.fail(a,t.message))}})};$(".js_grp_members").on("click",n)});
//# sourceMappingURL=groups.min.js.map
