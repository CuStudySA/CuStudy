$(function(){var t=$("<form id='js_form'>							<p>Kategória neve: <input type='text' name='name' required></p>					  </form>"),a=$("<li>							<div class='top'>								<span class='rovid'></span>								<span class='nev'></span>							</div>							<div class='bottom'>								<a class='typcn typcn-pencil js_thm_edit' title='Módosítás'></a>								<a class='typcn typcn-trash js_thm_del' title='Törlés'></a>							</div>					   </li>"),e=$("<div><h2 class='grouptitle'></h2>						<ul class='groups colorli'>							<li>								<div class='top'>									<span class='rovid'>Új csop.</span>									<span class='nev newTile'>Új csoport hozzáadása</span>								</div>								<div class='bottom'>									<a class='typcn typcn-plus' href='/groups/add/' title='Hozzáadás'></a>								</div>							</li>						</ul></div>"),r=$("#groupContainer");$(".js_grp_del").on("click",function(t){t.preventDefault();var a="Csoport törlése";$.Dialog.confirm(a,"Biztosan törlöd a csoportot? Ha a csoportnak vannak tagjai, a rendszer automatikusan kilépteti őket.",["Csop. törlése","Visszalépés"],function(e){if(e){var r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/groups/delete",data:pushToken({id:r}),success:function(t){t.status?($.Dialog.success(a,t.message),window.location.href="/groups"):$.Dialog.fail(a,t.message)}})}})});var s=function(a){a.preventDefault();var e="Csoportkategória szerkesztése",r=$(a.currentTarget).attr("href").substring(1);$.Dialog.wait(e,"Információk lekérése a szerverről..."),$.ajax({method:"POST",url:"/groups/theme/get",data:pushToken({id:r}),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;var s=t.clone();s.find("[name=name]").attr("value",a.name),$.Dialog.request(e,s.prop("outerHTML"),"js_form","Mentés",function(){var t=$("#js_form");t.on("submit",function(a){a.preventDefault(),$.Dialog.wait(e),$.ajax({method:"POST",url:"/groups/theme/edit",data:t.clone().append($('<input name="id">').attr("value",r)).serializeForm(),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(a.status){var s=$(".grps"),i=s.children("[data-id="+r+"]"),o=t.children(),n=o.find("[name=name]").val();i.find(".rovid").text(n+" kat.");var l=$(".new").detach();s.sortChildren(".rovid",!1),s.append(l),$('h2[data-thm="'+r+'"]').text(n+" csoportok"),$('div[data-thm="'+r+'"]').find("ul").find(".nev:not(.newTile)").text(n),$.Dialog.close()}else $.Dialog.fail(e,a.message)}})})})}})};$(".js_thm_edit").on("click",s);var i=function(i){i.preventDefault();var o="Csoportkategória hozzáadása",n=t.clone();$.Dialog.request(o,n.prop("outerHTML"),"js_form","Mentés",function(){var t=$("#js_form");t.on("submit",function(i){i.preventDefault(),$.Dialog.wait(o),$.ajax({method:"POST",url:"/groups/theme/add",data:t.serializeForm(),success:function(i){if("string"==typeof i)return console.log(i),$(window).trigger("ajaxerror"),!1;if(i.status){var n=a.clone(),l=t.children(),d=l.find("[name=name]").val();n.find(".rovid").text(d+" kat."),n.find(".js_thm_edit").attr("href","#"+i.id),n.find(".js_thm_del").attr("href","#"+i.id),n.attr("data-id",i.id);var c=$(".grps");c.append(n);var u=$(".new").detach();c.sortChildren(".rovid",!1),c.append(u),n.find(".js_thm_edit").on("click",s);var p=e.clone();p.find(".grouptitle").text(d+" csoportok").attr("data-thm",i.id),p.find(".bottom").children().eq(0).attr("href","/groups/add/"+i.id),p.filter("div").attr("data-thm",i.id),r.append(p),$.Dialog.close()}else $.Dialog.fail(o,i.message)}})})})};$(".js_thm_add").on("click",i);var o=function(t){t.preventDefault();var a="Csoportkategória törlése";$.Dialog.confirm(a,"Biztosan törölni szeretnéd a csoportkategóriát? A kategóriában lévő összes csoport is törlődik. A művelet nem visszavonható!",["Kat. törlése","Visszalépés"],function(e){if(e){$.Dialog.wait();var r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/groups/theme/delete",data:pushToken({id:r}),success:function(e){e.status?($(t.currentTarget).parent().parent().remove(),$("div[data-thm="+r+"]").remove(),$.Dialog.close()):$.Dialog.fail(a,e.message)}})}})};$(".js_thm_del").on("click",o);var n=function(t){t.preventDefault();var a=$(t.currentTarget).attr("href").substring(1),e="Csoport tagjainak lekérése";$.Dialog.wait(e),$.ajax({method:"POST",url:"/groups/members",data:pushToken({id:a}),success:function(t){return"object"!=typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?$.Dialog.info(e,t.html):$.Dialog.fail(e,t.message))}})};$(".js_grp_members").on("click",n)});
//# sourceMappingURL=groups.min.js.map
