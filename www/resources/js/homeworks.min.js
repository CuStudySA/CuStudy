$(function(){var e="Házi feladat hozzáadása",a="object"!=typeof _dispDays?"":_dispDays.slice(),t=!1,o=[],n=$("#lessonPicker"),i=$("#startDatePicker");$("textarea").eq(0).sceditor({plugins:"bbcode",toolbar:"bold,italic,underline|color,removeformat|cut,copy,paste|source",style:"/resources/addons/sceditor/jquery.sceditor.default.min.css",width:"80%",height:"170px",runWithoutWysiwygSupport:!0,locale:"hu",emoticonsEnabled:!1});var l=function(){var e=-1,a=$("tr");a.eq(1).children().each(function(a,t){var o=$(t);0==o.children().length&&(o.remove(),e=a)}),-1!=e&&(a.eq(0).children().eq(e).remove(),a.each(function(e,a){0==$(a).children().length&&$(a).remove()}))};n.on("click",".lesson",function(){$(".selectedLesson").removeClass("selectedLesson"),$(this).addClass("selectedLesson")}),$(".js_add_hw").click(function(){$(this).blur()});var s=function(e){e.preventDefault();var a=$(e.currentTarget),o=a.attr("href").substring(1),n="Házi feladat késznek jelölése";$.Dialog.wait(n),$.ajax({method:"POST",data:{id:o},url:"/homeworks/makeMarkedDone",success:function(i){return"object"!=typeof i?(console.log(i),$(window).trigger("ajaxerror"),!1):void(i.status?(t?($(e.currentTarget).replaceWith("<a class='typcn typcn-times js_undoMarkedDone' title='Késznek jelölés visszavonása' href='#"+o+"'></a>"),$("[href=#"+o+"]").filter(".js_undoMarkedDone").on("click",r)):(a.parent().detach(),l(),0==$("tbody").children().length&&$("table").replaceWith("<p>Nincs megjelenítendő házi feladat! A kezdéshez adjon hozzá egyet, vagy váltson nézetet!</p>")),$.Dialog.close()):$.Dialog.fail(n,i.message))}})};$(".js_makeMarkedDone").click(s);var r=function(e){e.preventDefault();var a=$(e.currentTarget),t=a.attr("href").substring(1),o="Házi feladat kész jelölésének eltávolítása";$.Dialog.wait(o),$.ajax({method:"POST",data:{id:t},url:"/homeworks/undoMarkedDone",success:function(a){return"object"!=typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($(e.currentTarget).replaceWith("<a class='typcn typcn-tick js_makeMarkedDone' title='Késznek jelölés' href='#"+t+"'></a>"),$("[href=#"+t+"]").filter(".js_makeMarkedDone").on("click",s),$.Dialog.close()):$.Dialog.fail(o,a.message))}})};$(".js_undoMarkedDone").click(r);var c=function(e){e.preventDefault();var a=$(".hwContent"),o="Házi feladatok lekérése";$.Dialog.wait(o),$.ajax({method:"POST",url:"/homeworks/getDoneHomeworks",dataType:"html",success:function(e){a.empty().append(e),$(".js_hideMarkedDone").on("click",d),$.Dialog.close(),$(".js_undoMarkedDone").click(r),$(".js_makeMarkedDone").click(s),t=!0},error:function(){$.Dialog.fail(o,"A házi feladatok lekérése nem sikerült egy ismeretlen hiba miatt!")}})};$(".js_showMarkedDone").on("click",c);var d=function(e){e.preventDefault();var a=$(".hwContent"),o="Házi feladatok lekérése";$.Dialog.wait(o),$.ajax({method:"POST",url:"/homeworks/getNotDoneHomeworks",dataType:"html",success:function(e){a.empty().append(e),$(".js_showMarkedDone").on("click",c),$.Dialog.close(),$(".js_undoMarkedDone").click(r),$(".js_makeMarkedDone").click(s),t=!1},error:function(){$.Dialog.fail(o,"A házi feladatok lekérése nem sikerült egy ismeretlen hiba miatt!")}})};$(".uploadField").on("change",function(e){o=e.target.files;var a=$(".infoContainer");"undefined"!=typeof o[0]?(a.show(),$(document.body).animate({scrollTop:a.offset().top-10},500)):a.hide()}),$(".sendForm").on("click",function(a){a.preventDefault();var t=$(".selectedLesson"),n=$(".BBCodeEditor").data("sceditor").val();if(0==t.length)return $.Dialog.fail(e,"A házi feladat hozzáadása nem sikerült, mert nincs kiválasztott tantárgy!");if(n.length<=7)return $.Dialog.fail(e,"A házi feladat hozzáadása nem sikerült, mert a házi feladat szövege kisebb mint nyolc!");$.Dialog.wait(e);var i=new FormData;$.each(o,function(e,a){i.append(e,a)}),"undefined"!=typeof o[0]&&(i.append("fileTitle",$("[name=fileTitle]").val()),i.append("fileDesc",$("[name=fileDesc]").val())),$.each({lesson:t.find(".del").attr("data-ttid"),text:n,week:t.closest("td").attr("data-week")},function(e,a){i.append(e,a)}),$.ajax({method:"POST",cache:!1,dataType:"json",processData:!1,contentType:!1,data:i,success:function(a){return"object"!=typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($.Dialog.success(e,a.message),setTimeout(function(){window.location.href="/homeworks"},2500)):$.Dialog.fail(e,a.message))}})});var u,f=$(".backWeek").on("click",function(){g("back")}),k=$(".nextWeek").on("click",function(){g("next")}),h="Órakiválasztó-felület frissítése",g=function(e){var t=$("#lessonPicker"),o=$(".backWeek");return"back"==e&&"disabled"==o.attr("disabled")?$.Dialog.fail(h,"A jelenlegi hétről nem tudsz visszalépni egy előző hétre!"):($.Dialog.wait(h),void $.ajax({method:"POST",url:"/homeworks/getTimetable/nextBack",data:{move:e,dispDays:a},success:function(e){a=e.dispDays,t.children().html(e.timetable),o.attr("disabled",e.lockBack).blur(),k.blur(),i.val(a[0]),$.Dialog.close()}}))};i.on("change",function(e){e.preventDefault();var t=$(this).val();return isNaN(Date.parse(t))?$.Dialog.fail("Léptetés","Érvénytelen dátum!"):("undefined"!=typeof u&&(u.abort(),u=void 0),$.Dialog.open&&"wait"===$.Dialog.open.type||$.Dialog.wait(h),void(u=$.ajax({method:"POST",url:"/homeworks/getTimetable/date",data:{date:t},success:function(e){a=e.dispDays,n.children().html(e.timetable),f.attr("disabled",e.lockBack).blur(),k.blur(),i.val(a[0]),$.Dialog.close(),u=void 0}})))}),$(".js_delete").click(function(e){e.preventDefault();var a=$(e.currentTarget),t=a.attr("href").substring(1),o="Házi feladat törlése";$.Dialog.confirm(o,"Arra készülsz, hogy törlöd a kiválasztott házi feladatot. Ez nem azt jelenti, hogy nem kell azt megcsinálnod, csupán azt, hogy azt a rendszer többé nem jelzi. Biztosan törlöd a bejegyzést a rendszerből?",["Bejegyzés törlése","Visszalépés"],function(e){e&&($.Dialog.wait(),$.ajax({method:"POST",url:"/homeworks/delete",data:{id:t},success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?(a.parent().remove(),l(),$.Dialog.close()):$.Dialog.fail(o,e.message))}}))})});var m=function(e){e.preventDefault(),$.Dialog.fail("Funkció fejlesztés alatt","A kívánt funckió jelen pillanatban nem elérhető, mert az még fejlesztés alatt van! Próbálkozz később!")};$(".js_finished").click(m),$(".js_more_info").click(m)});
//# sourceMappingURL=homeworks.min.js.map
