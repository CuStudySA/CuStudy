$(function(){var e="Házi feladat hozzáadása",a="object"!=typeof _dispDays?"":_dispDays.slice(),t=!1,o=[];$("textarea").eq(0).sceditor({plugins:"bbcode",toolbar:"bold,italic,underline|color,removeformat|cut,copy,paste|source",style:"/resources/addons/sceditor/jquery.sceditor.default.min.css",width:"80%",height:"170px",runWithoutWysiwygSupport:!0,locale:"hu",emoticonsEnabled:!1});var s=function(){var e=-1,a=$("tr");a.eq(1).children().each(function(a,t){var o=$(t);0==o.children().length&&(o.remove(),e=a)}),-1!=e&&(a.eq(0).children().eq(e).remove(),a.each(function(e,a){0==$(a).children().length&&$(a).remove()}))};$(".lesson").on("click",function(){$(".selectedLesson").removeClass("selectedLesson"),$(this).addClass("selectedLesson")}),$(".js_add_hw").click(function(){$(this).blur()});var n=function(e){e.preventDefault();var a=$(e.currentTarget),o=a.attr("href").substring(1),n="Házi feladat késznek jelölése";$.Dialog.wait(n),$.ajax({method:"POST",data:pushToken({id:o}),url:"/homeworks/makeMarkedDone",success:function(i){return"object"!=typeof i?(console.log(i),$(window).trigger("ajaxerror"),!1):void(i.status?(t?($(e.currentTarget).replaceWith("<a class='typcn typcn-times js_undoMarkedDone' title='Késznek jelölés visszavonása' href='#"+o+"'></a>"),$("[href=#"+o+"]").filter(".js_undoMarkedDone").on("click",l)):(a.parent().detach(),s(),0==$("tbody").children().length&&$("table").replaceWith("<p>Nincs megjelenítendő házi feladat! A kezdéshez adjon hozzá egyet, vagy váltson nézetet!</p>")),$.Dialog.close()):$.Dialog.fail(n,i.message))}})};$(".js_makeMarkedDone").click(n);var l=function(e){e.preventDefault();var a=$(e.currentTarget),t=a.attr("href").substring(1),o="Házi feladat kész jelölésének eltávolítása";$.Dialog.wait(o),$.ajax({method:"POST",data:pushToken({id:t}),url:"/homeworks/undoMarkedDone",success:function(a){return"object"!=typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($(e.currentTarget).replaceWith("<a class='typcn typcn-tick js_makeMarkedDone' title='Késznek jelölés' href='#"+t+"'></a>"),$("[href=#"+t+"]").filter(".js_makeMarkedDone").on("click",n),$.Dialog.close()):$.Dialog.fail(o,a.message))}})};$(".js_undoMarkedDone").click(l);var i=function(e){e.preventDefault();var a=$(".hwContent"),o="Házi feladatok lekérése";$.Dialog.wait(o),$.ajax({method:"POST",data:pushToken({}),url:"/homeworks/getDoneHomeworks",success:function(e){a.empty().append(e),$(".js_hideMarkedDone").on("click",r),$.Dialog.close(),$(".js_undoMarkedDone").click(l),$(".js_makeMarkedDone").click(n),t=!0},error:function(){$.Dialog.fail(o,"A házi feladatok lekérése nem sikerült egy ismeretlen hiba miatt!")}})};$(".js_showMarkedDone").on("click",i);var r=function(e){e.preventDefault();var a=$(".hwContent"),o="Házi feladatok lekérése";$.Dialog.wait(o),$.ajax({method:"POST",url:"/homeworks/getNotDoneHomeworks",data:pushToken({}),success:function(e){a.empty().append(e),$(".js_showMarkedDone").on("click",i),$.Dialog.close(),$(".js_undoMarkedDone").click(l),$(".js_makeMarkedDone").click(n),t=!1},error:function(){$.Dialog.fail(o,"A házi feladatok lekérése nem sikerült egy ismeretlen hiba miatt!")}})};$(".uploadField").on("change",function(e){o=e.target.files;var a=$(".infoContainer");"undefined"!=typeof o[0]?(a.show(),$(document.body).animate({scrollTop:a.offset().top-10},500)):a.hide()}),$(".sendForm").on("click",function(a){a.preventDefault();var t=$(".selectedLesson"),s=$(".BBCodeEditor").data("sceditor").val();if(0==t.length)return $.Dialog.fail(e,"A házi feladat hozzáadása nem sikerült, mert nincs kiválasztott tantárgy!");if(s.length<=7)return $.Dialog.fail(e,"A házi feladat hozzáadása nem sikerült, mert a házi feladat szövege kisebb mint nyolc!");$.Dialog.wait(e);var n=new FormData;$.each(o,function(e,a){n.append(e,a)}),"undefined"!=typeof o[0]&&(n.append("fileTitle",$("[name=fileTitle]").val()),n.append("fileDesc",$("[name=fileDesc]").val())),$.each(pushToken({lesson:t.find(".del").attr("data-id"),text:s,week:t.attr("data-week")}),function(e,a){n.append(e,a)}),$.ajax({method:"POST",cache:!1,dataType:"json",processData:!1,contentType:!1,data:n,success:function(a){return"object"!=typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($.Dialog.success(e,a.message),setTimeout(function(){window.location.href="/homeworks"},2500)):$.Dialog.fail(e,a.message))}})});var c="Órakiválasztó-felület frissítése",d=function(e){var t=$("#lessonPicker"),o=$(".backWeek");return"back"==e&&"disabled"==o.attr("disabled")?$.Dialog.fail(c,"A jelenlegi hétről nem tudsz visszalépni egy előző hétre!"):($.Dialog.wait(c),void $.ajax({method:"POST",url:"/homeworks/getTimetable/nextBack",data:pushToken({move:e,dispDays:a}),success:function(e){var s=$(e);a=JSON.parse(s.filter(".dispDays").detach().text());var n=JSON.parse(s.filter(".lockBack").detach().text());t.empty().append(s.prop("outerHTML")),n?o.attr("disabled","disabled"):o.removeAttr("disabled"),o.blur(),$(".nextWeek").blur(),$(".lesson").on("click",function(){$(".selectedLesson").removeClass("selectedLesson"),$(this).addClass("selectedLesson")}),$.Dialog.close()}}))};$(".backWeek").on("click",function(){d("back")}),$(".nextWeek").on("click",function(){d("next")}),$("#startDatePicker").on("change",function(){var e=$("#lessonPicker"),t=$(".backWeek");$.Dialog.wait(c),$.ajax({method:"POST",url:"/homeworks/getTimetable/date",data:pushToken({date:$(this).val()}),success:function(o){var s=$(o);a=JSON.parse(s.filter(".dispDays").detach().text());var n=JSON.parse(s.filter(".lockBack").detach().text());e.empty().append(s.prop("outerHTML")),n?t.attr("disabled","disabled"):t.removeAttr("disabled"),$(".lesson").on("click",function(){$(".selectedLesson").removeClass("selectedLesson"),$(this).addClass("selectedLesson")}),$.Dialog.close()}})}),$(".js_delete").click(function(e){e.preventDefault();var a=$(e.currentTarget),t=a.attr("href").substring(1),o="Házi feladat törlése";$.Dialog.confirm(o,"Arra készülsz, hogy törlöd a kiválasztott házi feladatot. Ez nem azt jelenti, hogy nem kell azt megcsinálnod, csupán azt, hogy azt a rendszer többé nem jelzi. Biztosan törlöd a bejegyzést a rendszerből?",["Bejegyzés törlése","Visszalépés"],function(e){e&&($.Dialog.wait(),$.ajax({method:"POST",url:"/homeworks/delete",data:pushToken({id:t}),success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?(a.parent().remove(),s(),$.Dialog.close()):$.Dialog.fail(o,e.message))}}))})});var u=function(e){e.preventDefault(),$.Dialog.fail("Funkció fejlesztés alatt","A kívánt funckió jelen pillanatban nem elérhető, mert az még fejlesztés alatt van! Próbálkozz később!")};$(".js_finished").click(u),$(".js_more_info").click(u)});
//# sourceMappingURL=homeworks.min.js.map
