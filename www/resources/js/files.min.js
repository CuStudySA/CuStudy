$(function(){function e(e){var t=$(this),a=this.files[0],n=t.parent(),o=t.next(),i=$(".fileFormContainer");if("undefined"!=typeof a){if(o.show(),f(a)&&n.remove(),"undefined"!=typeof t.parent().prop("prevFiles"))return;o.find('input[name="fileTitle"]').val(e.target.value.split(/(\\|\/)/g).pop()).next().focus(),$(e.currentTarget).parent().prop("prevFiles",e.target.files),i.append(r.clone(!0,!0))}else n.remove()}function t(e){e.preventDefault();var t=$(".uploadFileForm");t.show(),$(document.body).animate({scrollTop:t.offset().top-10},500)}function a(e){e.preventDefault();var t=new FormData,a=$(".uploadContainer").find("input[type=file]"),n="Feltöltés folyamatban";$.Dialog.wait(n,"Kérjük, ne zárja be ezt az ablakot, a fájlok feltöltése folyamatban van"),$.each(a,function(e,a){var n=a.files[0];"undefined"!=typeof n&&t.append(e,n)});var o=$(".uploadContainer").find(".infoContainer");$.each(o,function(e,a){var n=$(a);if("none"!=n.css("display")){var o=n.find("[name=fileTitle]"),i=n.find("[name=fileDesc]");t.append(e+".title",o.val()),t.append(e+".desc",i.val())}}),t.append("JSSESSID",getToken()),$.ajax({method:"POST",url:"/files/uploadFiles",cache:!1,processData:!1,contentType:!1,data:t,success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):($(".uploadFileForm").replaceWith(s),void(e.status?(u.html(e.filelist),$.Dialog.close(),"undefined"!=typeof e.storage&&i(e.storage)):$.Dialog.fail(n,e.message)))},error:function(){$.Dialog.fail(n,"A fájlok szerverre történő továbbítása sikertelenül zárult! Kérjük, próbálja újra!")}})}function n(e){e.preventDefault();var t=$(e.currentTarget).attr("href").substring(1),a="Dokumentum törlése";$.Dialog.confirm(a,"Arra készül, hogy törli a kiválasztott dokumentumot a szerverről. A művelet nem visszavonható! Folytatja?",["Végleges törlés","Mégse"],function(n){n&&($.Dialog.wait(a),$.ajax({method:"POST",url:"/files/delete",data:pushToken({id:t}),success:function(t){return"object"!=typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close(),"undefined"!=typeof t.storage&&i(t.storage)):$.Dialog.fail(a,t.message))}}))})}function o(e){e.preventDefault();var t=$(e.currentTarget).attr("href").substring(1),a="Dokumentum információk lekérése";$.Dialog.wait(a),$.ajax({method:"POST",url:"/files/getFileInfo",data:pushToken({id:t}),success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?$.Dialog.info(a,e.html):$.Dialog.fail(a,e.message))}})}function i(e){var t=e["Used%"];!isNaN(t)&&t>0?(0===c.length&&(c=$.mk("div").appendTo(d)),c.css("width",t+"%").attr("class","used "+(t>75?"high":"low"))):c.fadeOut(500,function(){c.remove()}),d.prev().html(function(){return this.innerHTML.replace(/^.*<br>/,e.Used+" ("+t+"%) felhasználva az osztály számára elérhető "+e.Available+"-ból.<br>")})}var r=$("		<div class='uploadContainer'>			<input type='file' class='uploadField' name='uploadField'>			<div class='infoContainer' style='display: none;'>				<input type='text' name='fileTitle' placeholder='Dokumentum címe' required autofocus='true'>				<textarea name='fileDesc' placeholder='Dokumentum tartalma, leírása' required></textarea>			</div>		</div>"),l=$(".uploadFileForm").on("click",".js_uploadFiles",a),s=l.clone(!0,!0),u=$("ul.files").on("click",".js_file_add",t);$(".uploadField").add(r.find(".uploadField")).on("change",e);var f=function(e){var t=$(".uploadContainer").find("input[type=file]"),a=0;return $.each(t,function(t,n){var o=n.files[0];"undefined"!=typeof o&&e.name==o.name&&o.size==e.size&&a++}),a>1},d=$("#storage-use").find(".indicator"),c=d.children(".used");u.on("click",".js_delete",n).on("click",".js_more_info",o)});
//# sourceMappingURL=files.min.js.map
