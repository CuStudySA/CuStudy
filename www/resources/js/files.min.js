$(function(){function e(e){e.preventDefault();var a=$(e.currentTarget).attr("href").substring(1),n="Dokumentum törlése";$.Dialog.confirm(n,"Arra készül, hogy törli a kiválasztott dokumentumot a szerverről. A művelet nem visszavonható! Folytatja?",["Végleges törlés","Mégse"],function(o){o&&($.Dialog.wait(n),$.ajax({method:"POST",url:"/files/delete",data:pushToken({id:a}),success:function(a){return"object"!=typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close(),"undefined"!=typeof a.storage&&t(a.storage)):$.Dialog.fail(n,a.message))}}))})}function a(e){e.preventDefault();var a=$(e.currentTarget).attr("href").substring(1),t="Dokumentum információk lekérése";$.Dialog.wait(t),$.ajax({method:"POST",url:"/files/getFileInfo",data:pushToken({id:a}),success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?$.Dialog.info(t,e.html):$.Dialog.fail(t,e.message))}})}function t(e){var a=e["Used%"];!isNaN(a)&&a>0?(0===c.length&&(c=$.mk("div").appendTo(f)),c.css("width",a+"%").attr("class","used "+(a>75?"high":"low"))):c.fadeOut(500,function(){c.remove()}),f.prev().text(e.Used+" ("+a+"%) felhasználva az osztály számára elérhető "+e.Available+"-ból.")}var n=$("		<div class='uploadContainer'>			<input type='file' class='uploadField' name='uploadField'>			<div class='infoContainer' style='display: none;'>				<input type='text' name='fileTitle' placeholder='Dokumentum címe' required autofocus='true'>				<textarea name='fileDesc' placeholder='Dokumentum tartalma, leírása' required></textarea>			</div>		</div>"),o=$(".uploadFileForm"),r=o.clone(),i=$("ul.files"),l=function(e){var a=$(".uploadContainer").find("input[type=file]"),t=0;return $.each(a,function(a,n){var o=n.files[0];"undefined"!=typeof o&&e.name==o.name&&o.size==e.size&&t++}),t>1},s=function(e){var a=e.target.files[0],t=$(e.currentTarget).parent().children().filter(".infoContainer"),o=$(".fileFormContainer");if("undefined"!=typeof a){if(t.show(),l(a)&&$(e.currentTarget).parent().remove(),"undefined"!=typeof $(e.currentTarget).parent().prop("prevFiles"))return;$(e.currentTarget).parent().prop("prevFiles",e.target.files),o.append(n.clone()),$(".uploadField").on("change",s)}else $(e.currentTarget).parent().remove()};$(".uploadField").on("change",s);var u=function(e){e.preventDefault();var a=$(".uploadFileForm");a.show(),$(document.body).animate({scrollTop:a.offset().top-10},500)};$(".js_file_add").on("click",u);var d=function(e){e.preventDefault();var a=new FormData,n=$(".uploadContainer").find("input[type=file]"),o="Feltöltés folyamatban";$.Dialog.wait(o,"Kérjük, ne zárja be ezt az ablakot, a fájlok feltöltése folyamatban van"),$.each(n,function(e,t){var n=t.files[0];"undefined"!=typeof n&&a.append(e,n)});var l=$(".uploadContainer").find(".infoContainer");$.each(l,function(e,t){var n=$(t);if("none"!=n.css("display")){var o=n.find("[name=fileTitle]"),r=n.find("[name=fileDesc]");a.append(e+".title",o.val()),a.append(e+".desc",r.val())}}),a.append("JSSESSID",getToken()),$.ajax({method:"POST",url:"/files/uploadFiles",cache:!1,processData:!1,contentType:!1,data:a,success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?(i.html(e.filelist),$.Dialog.close(),"undefined"!=typeof e.storage&&t(e.storage)):($(".uploadFileForm").remove(),$("main").append(r),$(".uploadField").on("change",s),$(".js_uploadFiles").on("click",d),$(".js_file_add").on("click",u),$.Dialog.fail(o,e.message)))},error:function(){$.Dialog.fail(o,"A fájlok szerverre történő továbbítása sikertelenül zárult! Kérjük, próbálja újra!")}})};$(".js_uploadFiles").on("click",d);var f=$("#storage-use").find(".indicator"),c=f.children(".used");i.on("click",".js_delete",e).on("click",".js_more_info",a)});
//# sourceMappingURL=files.min.js.map
