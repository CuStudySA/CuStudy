$(function(){var e=$("		<div class='uploadContainer'>			<input type='file' class='uploadField' name='uploadField'>			<div class='infoContainer' style='display: none;'>				<input type='text' name='fileTitle' placeholder='Dokumentum címe' required autofocus='true'>				<textarea name='fileDesc' placeholder='Dokumentum tartalma, leírása' required></textarea>			</div>		</div>"),a=$(".uploadFileForm").clone(),t=($(".uploadFileForm"),$(".fileFormContainer"),function(e){var a=$(".uploadContainer").find("input[type=file]"),t=0;return $.each(a,function(a,n){var o=n.files[0];"undefined"!=typeof o&&e.name==o.name&&o.size==e.size&&t++}),t>1}),n=function(a){var o=a.target.files[0],r=$(a.currentTarget).parent().children().filter(".infoContainer"),i=$(".fileFormContainer");if("undefined"!=typeof o){if(r.show(),t(o)&&$(a.currentTarget).parent().remove(),"undefined"!=typeof $(a.currentTarget).parent().prop("prevFiles"))return;$(a.currentTarget).parent().prop("prevFiles",a.target.files),i.append(e.clone()),$(".uploadField").on("change",n)}else $(a.currentTarget).parent().remove()};$(".uploadField").on("change",n);var o=function(e){e.preventDefault();var a=$(".uploadFileForm");a.show(),$(document.body).animate({scrollTop:a.offset().top-10},500)};$(".js_file_add").on("click",o);var r=function(e){e.preventDefault();var t=new FormData,i=$(".uploadContainer").find("input[type=file]"),l="Fájl(ok) feltöltése";$.Dialog.wait(l,"A fájlok feltöltése folyamatban van... Kérjük, ne zárja be ezt az ablakot!"),$.each(i,function(e,a){var n=a.files[0];"undefined"!=typeof n&&t.append(e,n)});var s=$(".uploadContainer").find(".infoContainer");$.each(s,function(e,a){var n=$(a);if("none"!=n.css("display")){var o=n.find("[name=fileTitle]"),r=n.find("[name=fileDesc]");t.append(e+".title",o.val()),t.append(e+".desc",r.val())}}),t.append("JSSESSID",getToken()),$.ajax({method:"POST",url:"/files/uploadFiles",cache:!1,processData:!1,contentType:!1,data:t,success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?($.Dialog.success(l,e.message),setTimeout(function(){window.location.href="/files"},2500)):($(".uploadFileForm").remove(),$("main").append(a),$(".uploadField").on("change",n),$(".js_uploadFiles").on("click",r),$(".js_file_add").on("click",o),$.Dialog.fail(l,e.message)))},error:function(){$.Dialog.fail(l,"A fájlok szerverre történő továbbítása sikertelenül zárult! Kérjük, próbálja újra!")}})};$(".js_uploadFiles").on("click",r);var i=function(e){e.preventDefault();var a=$(e.currentTarget).attr("href").substring(1),t="Dokumentum törlése";$.Dialog.confirm(t,"Arra készül, hogy törli a kiválasztott dokumentumot a szerverről. A művelet nem visszavonható! Folytatja?",["Végleges törlés","Visszalépés"],function(n){n&&($.Dialog.wait(t),$.ajax({method:"POST",url:"/files/delete",data:pushToken({id:a}),success:function(a){return"object"!=typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close()):$.Dialog.fail(t,a.message))}}))})};$(".js_delete").on("click",i);var l=function(e){e.preventDefault();var a=$(e.currentTarget).attr("href").substring(1),t="Dokumentum információk lekérése";$.Dialog.wait(t),$.ajax({method:"POST",url:"/files/getFileInfo",data:pushToken({id:a}),success:function(e){return"object"!=typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?$.Dialog.info(t,e.html):$.Dialog.fail(t,e.message))}})};$(".js_more_info").on("click",l)});
//# sourceMappingURL=files.min.js.map
