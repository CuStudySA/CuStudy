$(function(){displayError(),$("#dataform").on("submit",function(e){e.preventDefault();var a="Felhasználói adataim módosítása",t=$(this).serializeForm();$.Dialog.wait(a),$.ajax({method:"POST",url:"/profile/edit",data:t,success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?($.Dialog.success(a,e.message,!0),$(".name").text($("[name=name]").val()),$(".email").text($("[name=email]").val())):$.Dialog.fail(a,e.message))}}),$("[name=oldpassword], [name=password], [name=verpasswd]").val("")});var e=$("#connect_s"),a=$("#connect");a.on("click",function(a){a.preventDefault();var t=e.val();return t?void $.Dialog.confirm("Fiókok összekapcsolása","A fiókjának összekapcsolásához át kell irányítanunk Önt a szolgáltatójának weboldalára.<br>A sikeres azonosítás után a rendszer visszairányítja. Folytatja?",["Tovább a szolgáltatóhoz","Visszalépés"],function(e){e&&($.Dialog.wait(!1,"Átirányítjuk"),window.location.href="/profile/connect/"+t)}):$.Dialog.fail("Fiókok összekapcsolása","Fiókjának összekapcsolásához először válasszon ki egy szolgáltatót!")}),function t(){"use strict";$(".disconnect").off("click").on("click",function(t){t.preventDefault();var l="Fiókok leválasztása",o=$(this).closest(".conn-wrap"),i=o.find(".logo"),r=i.attr("title"),s=o.attr("data-prov");$.Dialog.confirm(l,"A kiválasztott szolgáltatóhoz kapcsolódó fiókot leválasztja a CuStudy fiókjáról, így az nem lesz látható a listában és nem lehet bejelentkezéshez használni. A művelet nem visszavonható! Folytatja?",["Leválasztás","Mégse"],function(t){t&&($.Dialog.wait(l),$.ajax({method:"POST",url:"/profile/unlink",data:pushToken({id:o.attr("data-id")}),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):t.status?($.Dialog.close(),o.remove(),e.append($.mk("option").attr("value",s).text(r)).closest(".conn-wrap").show(),void a.attr("disabled",!1)):$.Dialog.fail(l,t.message)}}))})}),$(".activeToggle").off("click").on("click",function(e){e.preventDefault();var a=(-1!==this.className.indexOf("typcn-tick")?"":"de")+"activate",t=$.capitalize(a.replace(/ate$/,"").replace("c","k")+"álás"),l="Fiókkapcsolat "+t.toLowerCase()+"a",o="deactivate"===a?"A kiválaszott szolgáltatóval annak újra aktiválásáig nem tud majd bejelentkezni. Folytatja?":"A kiválaszott szolgáltató aktiválásával újra be tud majd jelentkezni vele. Folytatja?",i=$(this),r=$(this).closest(".conn-wrap");$.Dialog.confirm(l,o,[t,"Mégse"],function(e){e&&($.Dialog.wait(l),$.ajax({method:"POST",url:"/profile/"+a,data:pushToken({id:r.attr("data-id")}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):e.status?($.Dialog.close(),i.toggleClass("typcn-power typcn-tick").toggleHtml(["Aktiválás","Deaktiválás"]),void i.parent().prev().html(function(){return this.innerHTML.replace(/^(Ina|A)/,function(e){return"A"===e?"Ina":"A"})})):$.Dialog.fail(l,e.message)}}))})}),$(".makepicture").off("click").on("click",function(e){e.preventDefault();var a="Profilkép szolgáltató megváltoztatása",l=$(this).closest(".conn-wrap"),o=l.find(".logo").attr("title"),i=l.attr("data-prov");$.Dialog.confirm(a,"A profilkép szolgáltató módosításával megváltoztathatod, hogy melyik kép jelenjen meg az oldalon a neved mellett.<br>Átváltasz a(z) "+o+" szolgáltatónál használt profilképre?",["Váltás","Maradjon a régi"],function(e){e&&($.Dialog.wait(a),$.post("/profile/setavatarprovider",pushToken({provider:i}),function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(!e.status)return $.Dialog.fail(a,e.message);var o="undefined"==typeof i,r=l.parent(),s=r.children().last();r.children("[data-id]").remove(),$(e.connwraps).insertBefore(s),t(),s.find(".status").text(o?"Jelenlegi profilkép":"Nincs használatban").next().children(".makepicture").attr("disabled",o),$("#sidebar").find(".avatar img").attr("src",e.picture),$.Dialog.close()}))})});var l=function(e){e.preventDefault();var a=$(e.currentTarget).attr("data-id"),t="Szerepkör alapértelmezetté tétele";if("undefined"==typeof a)throw new Error('Nincs megadva "data-id" paraméter!');$.Dialog.wait(),$.ajax({method:"POST",url:"/profile/roles/changeDefault",data:pushToken({id:a}),success:function(a){return"string"==typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($(".js_changeDefault").prop("disabled",!1),$(e.currentTarget).prop("disabled",!0),$.Dialog.close()):$.Dialog.fail(t,a.message))}})};$(".js_changeDefault").on("click",l);var o=function(e){e.preventDefault();var a="Szerepkör leválasztása";if($(e.currentTarget).parent().find(".js_changeDefault").prop("disabled"))return $.Dialog.fail(a,"Az alapértelemeztt szerepkör leválasztása nem lehetséges! A leválasztás előtt jelöljön ki egy másik szerepkört alapértelmezettként!");var t=$(e.currentTarget).attr("data-id"),l=$("<p>Arra készül, hogy leválasztja a kiválasztott szerepkört a fiókjáról. Ez azt jelenti, hogy egy osztálybeli szerepkör leválasztása esetén nem lesz képes a továbbiakban hozzáférni az osztályhoz!<br>							Ez a művelet nem visszavonható, így kérem, erősítse meg szándékát a jelszava begépelésével!</p>							<form id='js_form'>								<p><strong>Jelenlegi jelszava:</strong> <input type='password' name='password' required placeholder='Jelenlegi jelszava								'></p>								<input type='hidden' name='id'>							</form>");if("undefined"==typeof t)throw new Error('Nincs megadva "data-id" paraméter!');l.find("input[type=hidden]").attr("value",t),$.Dialog.request(a,l,"js_form","Leválasztás",function(e){e.on("submit",function(l){l.preventDefault();var o=e.serializeForm();$.Dialog.wait(),$.ajax({method:"POST",url:"/profile/roles/eject",data:o,success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){if(1==e.reload)return window.location.reload();$(".conn-wrap[data-id="+t+"]").remove(),$.Dialog.close()}else $.Dialog.fail(a,e.message)}})})})};$(".js_eject").on("click",o)}()});
//# sourceMappingURL=profile.min.js.map
