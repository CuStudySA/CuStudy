$("#dataform").on("submit",function(e){e.preventDefault();var a="Felhasználói adataim módosítása";$.Dialog.wait(a),$.ajax({method:"POST",url:"/profile/edit",data:$(this).serializeForm(),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?($.Dialog.success(a,e.message,!0),$(".name").text($("[name=name]").val()),$(".email").text($("[name=email]").val())):$.Dialog.fail(a,e.message))}}),$("[name=oldpassword], [name=password], [name=verpasswd]").val("")});var $connSel=$("#connect_s"),$connBtn=$("#connect");$connBtn.on("click",function(e){e.preventDefault();var a="Fiókok összekapcsolása",t=$connSel.val();return t?void $.Dialog.confirm(a,"A fiókjának összekapcsolásához át kell irányítanunk Önt a szolgáltatójának weboldalára.<br>A sikeres azonosítás után a rendszer visszairányítja. Folytatja?",["Tovább a szolgáltatóhoz","Visszalépés"],function(e){e&&($.Dialog.wait(a,"Átirányítjuk..."),window.location.href="/profile/connect/"+t)}):$.Dialog.fail("Fiókok összekapcsolása","Fiókjának összekapcsolásához először válasszon ki egy szolgáltatót!")}),function e(){"use setrict";$(".disconnect").off("click").on("click",function(e){e.preventDefault();var a="Fiókok leválasztása",t=$(this).closest(".conn-wrap"),o=t.find(".logo"),l=o.attr("title"),n=t.attr("data-prov");$.Dialog.confirm(a,"A kiválasztott szolgáltatóhoz kapcsolódó fiókot leválasztja a CuStudy fiókjáról, így az nem lesz látható a listában és nem lehet bejelentkezéshez használni. A művelet nem visszavonható! Folytatja?",["Leválasztás","Mégse"],function(e){e&&($.Dialog.wait(a),$.ajax({method:"POST",url:"/profile/unlink",data:pushToken({id:t.attr("data-id")}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):e.status?($.Dialog.close(),t.remove(),$connSel.append($.mk("option").attr("value",n).text(l)).closest(".conn-wrap").show(),void $connBtn.attr("disabled",!1)):$.Dialog.fail(a,e.message)}}))})}),$(".activeToggle").off("click").on("click",function(e){e.preventDefault();var a=(-1!==this.className.indexOf("typcn-tick")?"":"de")+"activate",t=$.capitalize(a.replace(/ate$/,"").replace("c","k")+"álás"),o="Fiókkapcsolat "+t.toLowerCase()+"a",l="deactivate"===a?"A kiválaszott szolgáltatóval annak újra aktiválásáig nem tud majd bejelentkezni. Folytatja?":"A kiválaszott szolgáltató aktiválásával újra be tud majd jelentkezni vele. Folytatja?",n=$(this),i=$(this).closest(".conn-wrap");$.Dialog.confirm(o,l,[t,"Mégse"],function(e){e&&($.Dialog.wait(o),$.ajax({method:"POST",url:"/profile/"+a,data:pushToken({id:i.attr("data-id")}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):e.status?($.Dialog.close(),n.toggleClass("typcn-power typcn-tick").toggleHtml(["Aktiválás","Deaktiválás"]),void n.parent().prev().html(function(){return this.innerHTML.replace(/^(Ina|A)/,function(e){return"A"===e?"Ina":"A"})})):$.Dialog.fail(o,e.message)}}))})}),$(".makepicture").off("click").on("click",function(a){a.preventDefault();var t="Profilkép szolgáltató megváltoztatása",o=$(this).closest(".conn-wrap"),l=o.find(".logo").attr("title"),n=o.attr("data-prov");$.Dialog.confirm(t,"A profilkép szolgáltató módosításával megváltoztathatod, hogy melyik kép jelenjen meg az oldalon a neved mellett.<br>Átváltasz a(z) "+l+" szolgáltatónál használt profilképre?",["Váltás","Maradjon a régi"],function(a){a&&($.Dialog.wait(t),$.post("/profile/setavatarprovider",pushToken({provider:n}),function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(!a.status)return $.Dialog.fail(t,a.message);var l="undefined"==typeof n,i=o.parent(),r=i.children().last();i.children("[data-id]").remove(),$(a.connwraps).insertBefore(r),e(),r.find(".status").text(l?"Jelenlegi profilkép":"Nincs használatban").next().children(".makepicture").attr("disabled",l),$("#sidebar").find(".avatar img").attr("src",a.picture),$.Dialog.close()}))})});var a=function(e){e.preventDefault();var a=$(e.currentTarget).attr("data-id"),t="Szerepkör alapértelmezetté tétele";if("undefined"==typeof a)throw new Error('Nincs megadva "data-id" paraméter!');$.Dialog.wait(),$.ajax({method:"POST",url:"/profile/roles/changeDefault",data:pushToken({id:a}),success:function(a){return"string"==typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($(".js_changeDefault").prop("disabled",!1),$(e.currentTarget).prop("disabled",!0),$.Dialog.close()):$.Dialog.fail(t,a.message))}})};$(".js_changeDefault").on("click",a);var t=function(e){e.preventDefault();var a="Szerepkör leválasztása";if($(e.currentTarget).parent().find(".js_changeDefault").prop("disabled"))return $.Dialog.fail(a,"Az alapértelemeztt szerepkör leválasztása nem lehetséges! A leválasztás előtt jelöljön ki egy másik szerepkört alapértelmezettként!");var t=$(e.currentTarget).attr("data-id"),o=$("<p>Arra készül, hogy leválasztja a kiválasztott szerepkört a fiókjáról. Ez azt jelenti, hogy egy osztálybeli szerepkör leválasztása esetén nem lesz képes a továbbiakban hozzáférni az osztályhoz!<br>						Ez a művelet nem visszavonható, így kérem, erősítse meg szándékát a jelszava begépelésével!</p>						<form id='js_form'>							<p><strong>Jelenlegi jelszava:</strong> <input type='password' name='password' required placeholder='Jelenlegi jelszava							'></p>							<input type='hidden' name='id'>						</form>");if("undefined"==typeof t)throw new Error('Nincs megadva "data-id" paraméter!');o.find("input[type=hidden]").attr("value",t),$.Dialog.request(a,o,"js_form","Leválasztás",function(){var e=$("#js_form");e.on("submit",function(o){o.preventDefault(),$.Dialog.wait(),$.ajax({method:"POST",url:"/profile/roles/eject",data:e.serializeForm(),success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;if(e.status){if(1==e.reload)return window.location.reload();$(".conn-wrap[data-id="+t+"]").remove(),$.Dialog.close()}else $.Dialog.fail(a,e.message)}})})})};$(".js_eject").on("click",t)}();
//# sourceMappingURL=profile.min.js.map
