$("#dataform").on("submit",function(t){t.preventDefault();var a="Felhasználói adataim módosítása";$.Dialog.wait(a),$.ajax({method:"POST",url:"/profile/edit",data:$(this).serializeForm(),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):void(t.status?($.Dialog.success(a,t.message,!0),$(".name").text($("[name=name]").val()),$(".email").text($("[name=email]").val())):$.Dialog.fail(a,t.message))}}),$("[name=oldpassword], [name=password], [name=verpasswd]").val("")});var $connSel=$("#connect_s"),$connBtn=$("#connect");$connBtn.on("click",function(t){t.preventDefault();var a="Fiókok összekapcsolása",e=$connSel.val();return e?void $.Dialog.confirm(a,"A fiókjának összekapcsolásához át kell irányítanunk Önt a szolgáltatójának weboldalára.<br>A sikeres azonosítás után a rendszer visszairányítja. Folytatja?",["Tovább a szolgáltatóhoz","Visszalépés"],function(t){t&&($.Dialog.wait(a,"Átirányítjuk..."),window.location.href="/profile/connect/"+e)}):$.Dialog.fail("Fiókok összekapcsolása","Fiókjának összekapcsolásához először válasszon ki egy szolgáltatót!")}),function t(){"use setrict";$(".disconnect").off("click").on("click",function(t){t.preventDefault();var a="Fiókok leválasztása",e=$(this).closest(".conn-wrap"),o=e.find(".logo"),l=o.attr("title"),n=e.attr("data-prov");$.Dialog.confirm(a,"A kiválasztott szolgáltatóhoz kapcsolódó fiókot leválasztja a CuStudy fiókjáról, így az nem lesz látható a listában és nem lehet bejelentkezéshez használni. A művelet nem visszavonható! Folytatja?",["Leválasztás","Mégse"],function(t){t&&($.Dialog.wait(a),$.ajax({method:"POST",url:"/profile/unlink",data:pushToken({id:e.attr("data-id")}),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):t.status?($.Dialog.close(),e.remove(),$connSel.append($.mk("option").attr("value",n).text(l)).closest(".conn-wrap").show(),void $connBtn.attr("disabled",!1)):$.Dialog.fail(a,t.message)}}))})}),$(".activeToggle").off("click").on("click",function(t){t.preventDefault();var a=(-1!==this.className.indexOf("typcn-tick")?"":"de")+"activate",e=$.capitalize(a.replace(/ate$/,"").replace("c","k")+"álás"),o="Fiókkapcsolat "+e.toLowerCase()+"a",l="deactivate"===a?"A kiválaszott szolgáltatóval annak újra aktiválásáig nem tud majd bejelentkezni. Folytatja?":"A kiválaszott szolgáltató aktiválásával újra be tud majd jelentkezni vele. Folytatja?",n=$(this),i=$(this).closest(".conn-wrap");$.Dialog.confirm(o,l,[e,"Mégse"],function(t){t&&($.Dialog.wait(o),$.ajax({method:"POST",url:"/profile/"+a,data:pushToken({id:i.attr("data-id")}),success:function(t){return"string"==typeof t?(console.log(t),$(window).trigger("ajaxerror"),!1):t.status?($.Dialog.close(),n.toggleClass("typcn-power typcn-tick").toggleHtml(["Aktiválás","Deaktiválás"]),void n.parent().prev().html(function(){return this.innerHTML.replace(/^(Ina|A)/,function(t){return"A"===t?"Ina":"A"})})):$.Dialog.fail(o,t.message)}}))})}),$(".makepicture").off("click").on("click",function(a){a.preventDefault();var e="Profilkép szolgáltató megváltoztatása",o=$(this).closest(".conn-wrap"),l=o.find(".logo").attr("title"),n=o.attr("data-prov");$.Dialog.confirm(e,"A profilkép szolgáltató módosításával megváltoztathatod, hogy melyik kép jelenjen meg az oldalon a neved mellett.<br>Átváltasz a(z) "+l+" szolgáltatónál használt profilképre?",["Váltás","Maradjon a régi"],function(a){a&&($.Dialog.wait(e),$.post("/profile/setavatarprovider",pushToken({provider:n}),function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(!a.status)return $.Dialog.fail(e,a.message);var l="undefined"==typeof n,i=o.parent(),s=i.children().last();i.children("[data-id]").remove(),$(a.connwraps).insertBefore(s),t(),s.find(".status").text(l?"Jelenlegi profilkép":"Nincs használatban").next().children(".makepicture").attr("disabled",l),$("#sidebar").find(".avatar img").attr("src",a.picture),$.Dialog.close()}))})})}();
//# sourceMappingURL=profile.min.js.map
