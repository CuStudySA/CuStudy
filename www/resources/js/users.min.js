$(function(){var e,a=$("<form id='js_form'>						<p>Felhasználónév: <input type='text' name='username' placeholder='Felhasználónév' required disabled></p>						<p>E-mail cím: <input type='text' name='email' placeholder='email@provider.mail' required disabled></p>						<p>Jogosultság: 							<select name='role'>								<option value='visitor' selected>Ált. felhasználó</option>								<option value='editor'>Szerkesztő</option>								<option value='admin'>Csoport adminisztrátor</option>							</select></p>						<input type='hidden' name='id' value=''>				</form>"),t=$(".invite_form").detach().css("display","block"),l=function(a){a.preventDefault(),e instanceof jQuery&&e.remove(),e=t.clone(),$("main").append(e),$(document.body).animate({scrollTop:e.offset().top-10},500),$(".addlesson").click(function(){var e=$("[name=name]").val(),a=$("[name=email]").val(),t=$(".l_l_utag"),l=!1,n="Felhasználók meghívása",i=new RegExp($("[name=name]").attr("pattern")),r=new RegExp($("[name=email]").attr("pattern"));return i.test(e)?r.test(a)?($.each(t.children(),function(e,t){var i=$(t).attr("data-email");return i==a?($.Dialog.fail(n,"Már hozzáadtad ezt a felhasználót!"),l=!0,$("[name=name]").val(""),void $("[name=email]").val("")):void 0}),void(l||($(".l_l_utag").append('<li data-email="'+a+'" data-name="'+e+'"><b>'+e+"</b> ("+a+')<span class="typcn typcn-times l_l_deleteopt"></span></li>'),$(".l_l_empty").remove(),$("[name=name]").val(""),$("[name=email]").val(""),$(".l_l_deleteopt").on("click",function(){var e=$(this).parent(),a=$(".l_l_utag");e.remove(),0==a.children().size()&&a.append('<li class="l_l_empty">(nincs)</li>')})))):void $.Dialog.fail(n,"Az e-mail cím formátuma nem megfelelő! Kérjük írjon be egy helyes e-mail címet!"):void $.Dialog.fail(n,"A felhasználó nevének formátuma nem megfelelő! Kérjük írjon be egy helyes nevet!")});var l=[],n=!1;$(".a_t_f_sendButton").click(function(){if(n!==!0){n=!0;var a=$(".l_l_utag"),t="Felhasználók meghívása";$.each(a.children(),function(e,a){if(!$(a).hasClass("l_l_empty")){var t=$(a).attr("data-name"),n=$(a).attr("data-email");l.push({name:t,email:n})}}),$.Dialog.wait(t),$.ajax({method:"POST",url:"/users/invite",data:pushToken({invitations:l}),success:function(a){return"string"==typeof a?(console.log(a),$(window).trigger("ajaxerror"),!1):void(a.status?($.Dialog.success(t,a.message,!0),e.remove(),e=void 0):$.Dialog.fail(t,a.message))},complete:function(){n=!1}})}})};$(".js_invite").on("click",l);var n=function(e){e.preventDefault();var t="Felhasználó szerkesztése",l=$(e.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/users/get",data:pushToken({id:l}),success:function(e){if("string"==typeof e)return console.log(e),$(window).trigger("ajaxerror"),!1;var n=a.clone();n.find("[name=username]").attr("value",e.username),n.find("[name=email]").attr("value",e.email),n.find("[name=role]").children("option[value="+e.role+"]").attr("selected",!0),n.find("[name=id]").attr("value",l),$.Dialog.request(t,n.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");e.on("submit",function(a){a.preventDefault(),$.Dialog.wait(t),$.ajax({method:"POST",url:"/users/edit",data:e.serializeForm(),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?$.Dialog.close():$.Dialog.fail(t,e.message))}})})})}})};$(".js_user_edit").on("click",n);var i=function(e){e.preventDefault();var a="Felhasználó szerepkörének leválasztása";$.Dialog.confirm(a,"Arra készülsz, hogy törlöd a kiválasztott felhasználó osztáybeli szerepkörét, azaz törlöd a felhasználót az osztályból! Biztosan folytatod?",["Felhasználó törlése az osztályból","Visszalépés"],function(t){if(t){var l=$(e.currentTarget).attr("href").substring(1);$.Dialog.wait(a),$.ajax({method:"POST",url:"/users/eject",data:pushToken({id:l}),success:function(t){t.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close()):$.Dialog.fail(a,t.message)}})}})};$(".js_user_eject").on("click",i)});
//# sourceMappingURL=users.min.js.map
