$(function(){var e=$("<form id='js_form'>							<p>Felhasználónév: <input type='text' name='username' placeholder='Felhasználónév' required></p>							<p>Teljes név: <input type='text' name='name' placeholder='Vezetéknév Utónév' required></p>							<p>E-mail cím: <input type='text' name='email' placeholder='email@provider.mail' required></p>							<p>Jogosultság: 								<select name='role'>									<option value='visitor' selected>Ált. felhasználó</option>									<option value='editor'>Szerkesztő</option>									<option value='admin'>Csoport adminisztrátor</option>								</select></p>							<p>Aktív legyen?								<select name='active'>									<option value='1' selected>Igen</option>									<option value='0'>Nem</option>								</select></p>							<input type='hidden' name='id' value=''>					</form>"),a=$("<li>							<div class='top clearfix'>								<div class='left'>									<span class='typcn typcn-user'></span>									<span class='id'></span>								</div>								<div class='right'>									<span class='vnev'></span> <span class='knev'></span>								</div>							</div>							<div class='bottom'>								<a class='typcn typcn-pencil js_user_edit' href='' title='Módosítás'></a>								<a class='typcn typcn-key js_user_editAccessData' href='' title='Hozzáférési adatok módosítása'></a>								<a class='typcn typcn-user-delete js_user_delete' href='' title='Törlés'></a>							</div>						</li>"),t=$("<form id='js_form'>								<p>Új jelszó: <input type='password' name='newpassword' placeholder='Jelszó' required></p>								<p>Jelszó megerősítése: <input type='password' name='vernewpasswd' placeholder='Jelszó megerősítése' required></p>								<input type='hidden' name='id' value=''>							</form>");void 0!=typeof Patterns&&$.each(Patterns,function(a,n){if("message"!=a&&"status"!=a){var i=e.find("[name="+a+"]"),s=t.find("[name="+a+"]");i.length&&i.attr("pattern",n),s.length&&s.attr("pattern",n)}});var n,i=$(".invite_form").detach().css("display","block"),s=function(e){e.preventDefault(),n instanceof jQuery&&n.remove(),n=i.clone(),$("main").append(n),$(document.body).animate({scrollTop:n.offset().top-10},500),$(".addlesson").click(function(){var e=$("[name=name]").val(),a=$("[name=email]").val(),t=$(".l_l_utag"),n=!1,i="Felhasználók meghívása",s=new RegExp($("[name=name]").attr("pattern")),l=new RegExp($("[name=email]").attr("pattern"));return s.test(e)?l.test(a)?($.each(t.children(),function(e,t){var s=$(t).attr("data-email");return s==a?($.Dialog.fail(i,"Már hozzáadtad ezt a felhasználót!"),n=!0,$("[name=name]").val(""),void $("[name=email]").val("")):void 0}),void(n||($(".l_l_utag").append('<li data-email="'+a+'" data-name="'+e+'"><b>'+e+"</b> ("+a+')<span class="typcn typcn-times l_l_deleteopt"></span></li>'),$(".l_l_empty").remove(),$("[name=name]").val(""),$("[name=email]").val(""),$(".l_l_deleteopt").on("click",function(){var e=$(this).parent(),a=$(".l_l_utag");e.remove(),0==a.children().size()&&a.append('<li class="l_l_empty">(nincs)</li>')})))):void $.Dialog.fail(i,"Az e-mail cím formátuma nem megfelelő! Kérjük írjon be egy helyes e-mail címet!"):void $.Dialog.fail(i,"A felhasználó nevének formátuma nem megfelelő! Kérjük írjon be egy helyes nevet!")});var a=[],t=!1;$(".a_t_f_sendButton").click(function(){if(t!==!0){t=!0;var e=$(".l_l_utag"),i="Felhasználók meghívása";$.each(e.children(),function(e,t){if(!$(t).hasClass("l_l_empty")){var n=$(t).attr("data-name"),i=$(t).attr("data-email");a.push({name:n,email:i})}}),$.Dialog.wait(i),$.ajax({method:"POST",url:"/users/invite",data:pushToken({invitations:a}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?($.Dialog.success(i,e.message,!0),n.remove(),n=void 0,$.Dialog.close()):$.Dialog.fail(i,e.message))},complete:function(){t=!1}})}})};$(".js_invite").on("click",s);var l=function(e){e.preventDefault();var a="Felhasználó szerkesztése",n=$(e.currentTarget).attr("href").substring(1),i=t.clone();i.find("[name=id]").attr("value",n),$.Dialog.request(a,i.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");e.on("submit",function(t){t.preventDefault(),$.Dialog.wait(a),$.ajax({method:"POST",url:"/users/editAccessData",data:e.serializeForm(),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.status?$.Dialog.close():$.Dialog.fail(a,e.message))}})})})},r=function(a){a.preventDefault();var t="Felhasználó szerkesztése",n=$(a.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/users/get",data:pushToken({id:n}),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;var i=e.clone();i.find("[name=username]").attr("value",a.username).attr("disabled","true"),i.find("[name=name]").attr("value",a.name),i.find("[name=email]").attr("value",a.email),i.find("[name=role]").children("option[value="+a.role+"]").attr("selected",!0),i.find("[name=active]").children("option[value="+a.active+"]").attr("selected",!0),i.find("[name=id]").attr("value",n),$.Dialog.request(t,i.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");e.on("submit",function(a){a.preventDefault(),$.Dialog.wait(t),$.ajax({method:"POST",url:"/users/edit",data:e.serializeForm(),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(a.status){var i=$("ul"),s=i.children("[data-id="+n+"]"),l=e.children(),r=l.find("[name=name]").val().split(" ");s.find(".vnev").text(r.slice(0,1).toString()),s.find(".knev").text(r.slice(1).join(" "));var o=$(".new").detach();i.sortChildren(".vnev",!1),i.append(o),$.Dialog.close()}else $.Dialog.fail(t,a.message)}})})})}})},o=function(t){t.preventDefault();var n="Felhasználó hozzáadás",i=e.clone();i.find("[name=id]").remove(),$.Dialog.request(n,i.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");e.on("submit",function(t){t.preventDefault(),$.Dialog.wait(n),$.ajax({method:"POST",url:"/users/add",data:e.serializeForm(),success:function(t){if("string"==typeof t)return console.log(t),$(window).trigger("ajaxerror"),!1;if(t.status){var i=a.clone(),s=e.children(),o=s.find("[name=name]").val().split(" ");i.find(".vnev").text(o.slice(0,1).toString()),i.find(".knev").text(o.slice(1).join(" ")),i.find(".id").text("#"+t.id),i.find(".js_user_edit").attr("href","#"+t.id),i.find(".js_user_delete").attr("href","#"+t.id),i.find(".js_user_editAccessData").attr("href","#"+t.id),i.attr("data-id",t.id);var c=$("ul");c.append(i);var u=$(".new").detach();c.sortChildren(".vnev",!1),c.append(u),i.find(".js_user_edit").on("click",r),i.find(".js_user_delete").on("click",d),i.find(".js_user_editAccessData").on("click",l),$.Dialog.close()}else $.Dialog.fail(n,t.message)}})})})},d=function(e){e.preventDefault();var a="Felhasználó törlése";$.Dialog.confirm(a,"Biztosan törölni szeretnéd a felhasználót? A művelet nem visszavonható!",["Felh. törlése","Visszalépés"],function(t){if(t){$.Dialog.wait();var n=$(e.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/users/delete",data:pushToken({id:n}),success:function(t){t.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close()):$.Dialog.fail(a,t.message)}})}})};$(".js_user_edit").on("click",r),$(".js_user_add").on("click",o),$(".js_user_delete").on("click",d),$(".js_user_editAccessData").on("click",l)});
//# sourceMappingURL=users.min.js.map
