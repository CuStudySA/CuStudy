$(function(){var e=$("<form method='POST' id='js_form'>						<p>Tantárgy neve: <input type='text' name='name' value='' pattern='^[A-Za-zöüóőúéáűÖÜÓŐÚÉÁŰ.() ]{4,15}$' required placeholder='Tantárgy'></p>						<p>Előadó (tanár) neve:							<select name='teacherid'>							</select>						</p>						<p>Tantárgy színe: <input id='colorpicker' name='color' type='hidden' value='#000000'></p>						<input type='hidden' name='id' value=''>					</form>"),t=$("<li>							<div class='top'>								<span class='tantargy'></span>								<span class='tanar'></span>							</div>							<div class='bottom'>								<a class='typcn typcn-pencil js_lesson_edit' href='' title='Módosítás'></a>								<a class='typcn typcn-trash js_lesson_delete' href='' title='Törlés'></a>							</div>						</li>"),a=[],n="";$.ajax({method:"POST",url:"/lessons/get/teachers",data:pushToken({}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):(a=e.options,void a.forEach(function(e){n+=e}))}});var r=function(t){t.preventDefault();var a="Tantárgy szerkesztése",r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/lessons/get",data:pushToken({id:r}),success:function(t){if("string"==typeof t)return console.log(t),$(window).trigger("ajaxerror"),!1;var s=e.clone();s.find("[name=name]").attr("value",t.name),s.find("[name=color]").attr("value",t.color),s.find("[name=id]").attr("value",t.id),s.find("[name=teacherid]").append(n).children("option[value="+t.teacherid+"]").attr("selected",!0),$.Dialog.request(a,s.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");$("#colorpicker").spectrum({showInput:!0,showInitial:!0,preferredFormat:"hex",change:function(e){$("#colorpicker").attr("value",e.toHexString())}}),e.on("submit",function(t){t.preventDefault(),$.Dialog.wait(a),$.ajax({method:"POST",url:"/lessons/edit",data:e.serializeForm(),success:function(t){if("string"==typeof t)return console.log(t),$(window).trigger("ajaxerror"),!1;if(t.status){var n=$("ul").children("[data-id="+r+"]"),s=e.children();n.find(".tantargy").text(s.find("[name=name]").val()),n.find(".tanar").text(s.find("[name=teacherid]").find(":selected").text()),n.css("background-color",s.find("[name=color]").val());var o=$(".lessons"),i=$(".new").detach();o.sortChildren(".tantargy",!1),o.append(i),$.Dialog.close()}else $.Dialog.fail(a,t.message)}})})})}})},s=function(e){e.preventDefault();var t="Tantárgy törlése";$.Dialog.confirm(t,"Biztosan szeretnéd törölni a tantárgyat?",["Tantárgy törlése","Visszalépés"],function(a){if(a){var n=$(e.currentTarget).attr("href").substring(1);$.Dialog.wait(t),$.ajax({method:"POST",url:"/lessons/delete",data:pushToken({id:n}),success:function(a){a.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close()):$.Dialog.fail(t,a.message)}})}})},o=function(a){a.preventDefault();var o="Tantárgy hozzáadás",i=e.clone();i.find("[name=teacherid]").append(n),$.Dialog.request(o,i.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");e.find("[name=id]").detach(),$("#colorpicker").spectrum({change:function(e){$("#colorpicker").attr("value",e.toHexString())}}),e.on("submit",function(a){a.preventDefault(),$.Dialog.wait(o),$.ajax({method:"POST",url:"/lessons/add",data:e.serializeForm(),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(a.status){var n=t.clone(),i=e.children();n.find(".tantargy").text(i.find("[name=name]").val()),n.find(".tanar").text(i.find("[name=teacherid]").find(":selected").text()),n.css("background-color",i.find("[name=color]").val()),n.attr("data-id",a.id),n.find(".js_lesson_edit").attr("href","#"+a.id),n.find(".js_lesson_delete").attr("href","#"+a.id);var l=$(".lessons");l.append(n);var c=$(".new").detach();l.sortChildren(".tantargy",!1),l.append(c),n.find(".js_lesson_edit").on("click",r),n.find(".js_lesson_delete").on("click",s),$.Dialog.close()}else $.Dialog.fail(o,a.message)}})})})};$(".js_lesson_add").on("click",o),$(".js_lesson_edit").on("click",r),$(".js_lesson_delete").on("click",s)});
//# sourceMappingURL=lessons.min.js.map
