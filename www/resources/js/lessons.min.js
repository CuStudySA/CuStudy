$(function(){var e=$("<form method='POST' id='js_form'>						<p>Tantárgy neve: <input type='text' name='name' value='' pattern='^[A-Za-zöüóőúéáűÖÜÓŐÚÉÁŰ.() ]{4,15}$' required placeholder='Tantárgy'></p>						<p>Előadó (tanár) neve:							<select name='teacherid'>							</select>						</p>						<p>Tantárgy színe: <input id='colorpicker' name='color' type='hidden' value='#000000'></p>						<input type='hidden' name='id' value=''>					</form>"),t=$("<li>							<div class='top'>								<span class='tantargy'></span>								<span class='tanar'></span>							</div>							<div class='bottom'>								<a class='typcn typcn-pencil js_lesson_edit' href='' title='Módosítás'></a>								<a class='typcn typcn-trash js_lesson_delete' href='' title='Törlés'></a>							</div>						</li>"),a="";$.ajax({method:"POST",url:"/lessons/get/teachers",data:pushToken({}),success:function(e){return"string"==typeof e?(console.log(e),$(window).trigger("ajaxerror"),!1):void(e.options&&$.each(e.options,function(e,t){a+=t}))}});var n=function(t){t.preventDefault();var n="Tantárgy szerkesztése",r=$(t.currentTarget).attr("href").substring(1);$.ajax({method:"POST",url:"/lessons/get",data:pushToken({id:r}),success:function(t){if("string"==typeof t)return console.log(t),$(window).trigger("ajaxerror"),!1;var o=e.clone();o.find("[name=name]").attr("value",t.name),o.find("[name=color]").attr("value",t.color),o.find("[name=id]").attr("value",t.id),o.find("[name=teacherid]").append(a).children("option[value="+t.teacherid+"]").attr("selected",!0),$.Dialog.request(n,o.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");$("#colorpicker").spectrum({showInput:!0,showInitial:!0,preferredFormat:"hex",change:function(e){$("#colorpicker").attr("value",e.toHexString())}}),e.on("submit",function(t){t.preventDefault(),$.Dialog.wait(n),$.ajax({method:"POST",url:"/lessons/edit",data:e.serializeForm(),success:function(t){if("string"==typeof t)return console.log(t),$(window).trigger("ajaxerror"),!1;if(t.status){var a=$("ul").children("[data-id="+r+"]"),o=e.children();a.find(".tantargy").text(o.find("[name=name]").val()),a.find(".tanar").text(o.find("[name=teacherid]").find(":selected").text()),a.css("background-color",o.find("[name=color]").val());var s=$(".lessons"),i=$(".new").detach();s.sortChildren(".tantargy",!1),s.append(i),$.Dialog.close()}else $.Dialog.fail(n,t.message)}})})})}})},r=function(e){e.preventDefault();var t="Tantárgy törlése";$.Dialog.confirm(t,"Biztosan szeretnéd törölni a tantárgyat?",["Tantárgy törlése","Visszalépés"],function(a){if(a){var n=$(e.currentTarget).attr("href").substring(1);$.Dialog.wait(t),$.ajax({method:"POST",url:"/lessons/delete",data:pushToken({id:n}),success:function(a){a.status?($(e.currentTarget).parent().parent().remove(),$.Dialog.close()):$.Dialog.fail(t,a.message)}})}})},o=function(o){o.preventDefault();var s="Tantárgy hozzáadás";if(0===a.length)return $.Dialog.fail(s,'Tantárgyak felvétele előtt hozzá kell adnod tanárokat a <a href="/teachers">Tanárok</a> menüpontban!');var i=e.clone();i.find("[name=teacherid]").append(a),$.Dialog.request(s,i.prop("outerHTML"),"js_form","Mentés",function(){var e=$("#js_form");e.find("[name=id]").detach(),$("#colorpicker").spectrum({change:function(e){$("#colorpicker").attr("value",e.toHexString())}}),e.on("submit",function(a){a.preventDefault(),$.Dialog.wait(s),$.ajax({method:"POST",url:"/lessons/add",data:e.serializeForm(),success:function(a){if("string"==typeof a)return console.log(a),$(window).trigger("ajaxerror"),!1;if(a.status){var o=t.clone(),i=e.children();o.find(".tantargy").text(i.find("[name=name]").val()),o.find(".tanar").text(i.find("[name=teacherid]").find(":selected").text()),o.css("background-color",i.find("[name=color]").val()),o.attr("data-id",a.id),o.find(".js_lesson_edit").attr("href","#"+a.id),o.find(".js_lesson_delete").attr("href","#"+a.id);var l=$(".lessons");l.append(o);var c=$(".new").detach();l.sortChildren(".tantargy",!1),l.append(c),o.find(".js_lesson_edit").on("click",n),o.find(".js_lesson_delete").on("click",r),$.Dialog.close()}else $.Dialog.fail(s,a.message)}})})})};$(".js_lesson_add").on("click",o),$(".js_lesson_edit").on("click",n),$(".js_lesson_delete").on("click",r)});
//# sourceMappingURL=lessons.min.js.map
